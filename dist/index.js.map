{"version":3,"file":"index.js","sources":["../src/npc/faceUserSystem.ts","../src/utils/default-ui-components.ts","../src/utils/types.ts","../src/ui/resources.ts","../src/utils/timerComponents.ts","../src/ui/index.ts","../src/trigger/triggerSystem.ts","../src/npc/move.ts","../src/ui/bubble.ts","../src/npc/npc.ts"],"sourcesContent":["@Component('trackUserFlag')\nexport class TrackUserFlag {\n  lockXZRotation: boolean = false\n  active: boolean = false\n  rotSpeed: number\n  constructor(lockXZRotation?: boolean, rotSpeed?: number, active?: boolean) {\n    if (!faceUserAdded) {\n      addFaceUserSystem()\n    }\n\n    this.lockXZRotation = lockXZRotation ? lockXZRotation : false\n\n    this.rotSpeed = rotSpeed ? rotSpeed : 2\n\n    if (active) {\n      this.active = true\n    }\n  }\n}\n\nlet faceUserAdded: boolean = false\nconst player = Camera.instance\n\n// Rotates NPC to face the user during interaction\nexport function addFaceUserSystem() {\n  faceUserAdded = true\n\n  engine.addSystem(new FaceUserSystem())\n}\n\nclass FaceUserSystem implements ISystem {\n  private followingNPCs = engine.getComponentGroup(TrackUserFlag)\n  update(dt: number) {\n    for (let npc of this.followingNPCs.entities) {\n      let transform = npc.getComponent(Transform)\n      let trackUser = npc.getComponent(TrackUserFlag)\n      if (trackUser.active) {\n        // Rotate to face the player\n        let lookAtTarget = new Vector3(player.position.x, player.position.y, player.position.z)\n        let direction = lookAtTarget.subtract(transform.position)\n        transform.rotation = Quaternion.Slerp(\n          transform.rotation,\n          Quaternion.LookRotation(direction),\n          dt * trackUser.rotSpeed\n        )\n\n        if (trackUser.lockXZRotation) {\n          transform.rotation.x = 0\n          transform.rotation.z = 0\n        }\n      }\n    }\n  }\n}\n","import { ImageSection } from \"./types\"\n\nexport const canvas = new UICanvas()\ncanvas.visible = true\n\nexport let SFFont = new Font(Fonts.SanFrancisco)\n\nexport let SFHeavyFont = new Font(Fonts.SanFrancisco_Heavy)\n\nexport let lightTheme = new Texture('https://decentraland.org/images/ui/light-atlas-v3.png')\nexport let darkTheme = new Texture('https://decentraland.org/images/ui/dark-atlas-v3.png')\n\nexport let bubblesTexture = new Texture('https://decentraland.org/images/ui/dialog-bubbles.png')\n\n\nexport function setUVs(\n\tplane: PlaneShape,\n\t_uv00: Vector2,\n\t_uv10: Vector2,\n\t_uv11: Vector2,\n\t_uv01: Vector2\n  ) {\n\t//log(_uv00, _uv10, _uv11, _uv01)\n\tplane.uvs = [\n\t  _uv00.x,\n\t  _uv00.y,\n  \n\t  _uv10.x,\n\t  _uv10.y,\n  \n\t  _uv11.x,\n\t  _uv11.y,\n  \n\t  _uv01.x,\n\t  _uv01.y,\n\t  //----\n\t  _uv00.x,\n\t  _uv00.y,\n  \n\t  _uv10.x,\n\t  _uv10.y,\n  \n\t  _uv11.x,\n\t  _uv11.y,\n  \n\t  _uv01.x,\n\t  _uv01.y,\n\t]\n  }\n  \n  export function setUVSection(\n\tplane: PlaneShape,\n\tsection: ImageSection,\n\tsizeX: number = 512,\n\tsizeY: number = 512\n  ) {\n\tsetUVs(\n\t  plane,\n\t  new Vector2(\n\t\tsection.sourceLeft / sizeX,\n\t\t(sizeY - section.sourceTop - section.sourceHeight) / sizeY\n\t  ),\n\t  new Vector2(\n\t\t(section.sourceLeft + section.sourceWidth) / sizeX,\n\t\t(sizeY - section.sourceTop - section.sourceHeight) / sizeY\n\t  ),\n  \n\t  new Vector2(\n\t\t(section.sourceLeft + section.sourceWidth) / sizeX,\n\t\t(sizeY - section.sourceTop) / sizeY\n\t  ),\n\t  new Vector2(section.sourceLeft / sizeX, (sizeY - section.sourceTop) / sizeY)\n\t)\n  }\n  ","/**\n * Fragment of a conversation with an NPC\n *\n * @typedef {Object} Dialog - An entry in an NPC conversation\n * @property {string} text The dialog text\n * @property {string} name Optional name of the dialog entry, to link other entries to this one and not worry about changes in the array length\n * @property {number} fontSize Size of the text\n * @property {number} offsetX Offset of the text on the X axis, relative to its normal position.\n * @property {number} offsetY Offset of the text on the Y axis, relative to its normal position.\n * @property {ImageData} portrait Sets the portrait image to use on the left. This field expects a `Portrait` object.\n * @property {ImageData} image Sets a second image to use on the right of the dialog, and slightly up. This field expects an `ImageData` object.\n * @property {number} typeSpeed The text appears one character at a time, simulating typing. Players can click to skip the animation. Tune the speed of this typing (30 by default) to go slower or faster. Set to _-1_ to skip the animation.\n * @property {boolean} isQuestion If true, allows to use buttons to trigger different actions\n * @property {boolean} isFixedScreen If true, has no buttons or \"next page\" functionality\n * @property {ButtonData[]} buttons An array of buttons `ButtonData` objects to use in a question entry\n * @property {string} audio Path to sound file to play when the dialog is shown in the UI\n * @property {boolean} skipable If true, a \"Skip\" button on the UI lets players skip to the next non-skipable entry.\n * @property {number} timeOn How long to keep the text visible before moving on to the next entry. Only for bubble dialogs!\n *\n */\nexport type Dialog = {\n  text?: string\n  name?: string\n  fontSize?: number\n  offsetX?: number\n  offsetY?: number\n  typeSpeed?: number\n  isEndOfDialog?: boolean\n  triggeredByNext?: (text?:string) => void\n  portrait?: ImageData\n  image?: ImageData\n  isQuestion?: boolean\n  isEntryQuestion?:boolean\n  isFixedScreen?: boolean\n  buttons?: ButtonData[]\n  audio?: string\n  skipable?: boolean\n  timeOn?: number\n}\n\n/**\n *\n * @typedef {Object} TriggerData - Object with data for a NPCTriggerComponent\n * @property {number} layer  layer of the Trigger, useful to discriminate between trigger events. You can set multiple layers by using a | symbol.\n * @property {number} triggeredByLayer against which layers to check collisions\n * @property {(entity: Entity) => void } onTriggerEnter callback when an entity of a valid layer enters the trigger area\n * @property {(entity: Entity) => void} onTriggerExit callback when an entity of a valid layer leaves the trigger area\n * @property {() => void} onCameraEnter callback when the player enters the trigger area\n * @property {() => void} onCameraExit callback when the player leaves the trigger area\n * @property {boolean} enableDebug when true makes the trigger area visible for debug purposes.\n */\nexport type TriggerData = {\n  layer?: number\n  triggeredByLayer?: number\n  onTriggerEnter?: (entity: Entity) => void\n  onTriggerExit?: (entity: Entity) => void\n  onCameraEnter?: () => void\n  onCameraExit?: () => void\n  enableDebug?: boolean\n}\n\n/**\n * Data for Button to show on a question in a Dialog entry\n *\n * @typedef {Object} ButtonData - Object with data for a Dialog UI button\n * @property {string|number} goToDialog The index or name of the next dialog entry to display when activated.\n * @property {string} label The label to show on the button.\n * @property {() => void} triggeredActions An additional function to run whenever the button is activated\n * @property {number} fontSize Font size of the text\n * @property {number}offsetX Offset of the text on the X axis, relative to its normal position.\n * @property {number} offsetY Offset of the text on the Y axis, relative to its normal position.\n *\n */\nexport type ButtonData = {\n  goToDialog: number | string\n  label: string\n  triggeredActions?: (text?:string) => void\n  fontSize?: number\n  offsetX?: number\n  offsetY?: number\n}\n\nexport enum ButtonStyles {\n  E = `e`,\n  F = `f`,\n  DARK = `dark`,\n  RED = `red`,\n  ROUNDBLACK = `roundblack`,\n  ROUNDWHITE = `roundwhite`,\n  ROUNDSILVER = `roundsilver`,\n  ROUNDGOLD = `roundgold`,\n  SQUAREBLACK = `squareblack`,\n  SQUAREWHITE = `squarewhite`,\n  SQUARESILVER = `squaresilver`,\n  SQUAREGOLD = `squaregold`,\n  WHITE = `white`\n}\n\n/**\n * An NPC capable of having conversations with the player, and play different animations.\n *\n * @typedef {Object} NPCData Object with data to instance a new NPC\n * @property {string|ImageData} portrait 2D image to show on the left-hand side of the dialog window. The structure of an `ImageData` object is described in detail below.\n * @property {number} reactDistance Radius in meters for the player to activate the NPC or trigger the `onWalkAway()` function when leaving the radius.\n * @property {string} idleAnim Name of the idle animation in the model. This animation is always looped. After playing a non-looping animation it returns to looping this one.\n * @property {boolean} faceUser Set if the NPC rotates to face the user while active.\n * @property {boolean} onlyExternalTrigger If true, the NPC can't be activated by clicking or walking near. Just by calling its `activate()` function.\n * @property {boolean} onlyClickTrigger If true, the NPC can't be activated by walking near. Just by clicking on it or calling its `activate()` function.\n * @property {boolean} onlyETrigger If true, the NPC can't be activated by walking near. Just by pressing E on it or calling its `activate()` function.\n * @property {() => void} onWalkAway Function to call every time the player walks out of the `reactDistance` radius.\n * @property {boolean} continueOnWalkAway f true,when the player walks out of the `reactDistance` radius, the dialog window stays open and the NPC keeps turning to face the player (if applicable). It doesn't affect the triggering of the `onWalkAway()` function.\n * @property {boolean} darkUI If true, the dialog UI uses the dark theme.\n * @property {number} coolDownDuration Change the cooldown period for activating the NPC again. The number is in seconds.\n * @property {string} hoverText Set the UI hover feedback when pointing the cursor at the NPC. _TALK_ by default.\n * @property {string} dialogSound Path to sound file to play once for every line of dialog read on the UI.\n * @property {string} walkingAnim Animation to play when walking with followPath\n * @property {number} walkingSpeed Default speed to use when walking with followPath\n * @property {Vector3[]} path Array of Vector3 points representing the default path to walk over. The NPC will walk looping over these points\n* @property {boolean} textBubble If true, the NPC can display text bubbles with dialogs\n * @property {number} bubbleHeight The default height to display text bubbles over the NPC's position\n * @property {boolean} noUI If true, no UI dialog elements are constructed. The NPC can use speech bubbles.\n*\n */\nexport type NPCData = {\n  portrait?: string | ImageData\n  reactDistance?: number\n  idleAnim?: string\n  faceUser?: boolean\n  turningSpeed?: number\n  onlyExternalTrigger?: boolean\n  onlyClickTrigger?: boolean\n  onlyETrigger?: boolean\n  onWalkAway?: () => void\n  continueOnWalkAway?: boolean\n  darkUI?: boolean\n  coolDownDuration?: number\n  hoverText?: string\n  dialogSound?: string\n  dialogCustomTheme?: Texture\n  walkingAnim?: string\n  walkingSpeed?: number\n  path?: Vector3[]\n  pathLerpType?: NPCLerpType\n  textBubble?: boolean\n  bubbleHeight?: number\n  noUI?: boolean\n  \n}\n\n/**\n * Make an NPC walk following a path\n *\n * @typedef {Object} FollowPathData - Object with data to describe a path that an NPC can walk\n * @property {Vector3[]} path Array of `Vector3` positions to walk over.\n * @property {number} speed Speed to move at while walking this path. If no `speed` or `totalDuration` is provided, it uses the NPC's `walkingSpeed`, which is _2_ by default.\n * @property {number} totalDuration The duration in _seconds_ that the whole path should take. The NPC will move at the constant speed required to finish in that time. This value overrides that of the _speed_.\n * @property {boolean} loop _boolean_ If true, the NPC walks in circles over the provided set of points in the path. _false_ by default, unless the NPC is initiated with a `path`, in which case it starts as _true_.\n * @property {boolean} curve _boolean_ If true, the path is traced a single smooth curve that passes over each of the indicated points. The curve is made out of straight-line segments, the path is stored with 4 times as many points as originally defined. _false_ by default.\n * @property {number} startingPoint Index position for what point to start from on the path. _0_ by default.\n * @property {() => void} onFinishCallback Function to call when the NPC finished walking over all the points on the path. This is only called when `loop` is _false_.\n * @property {() => void} onReachedPointCallback Function to call once every time the NPC reaches a point in the path.\n *\n */\nexport type FollowPathData = {\n  startingPoint?: number\n  loop?: boolean\n  curve?: boolean\n  totalDuration?: number\n  speed?: number\n  path?: Vector3[]\n  pathLerpType?: NPCLerpType\n  onFinishCallback?: () => void\n  onReachedPointCallback?: () => void\n}\n\n/**\n * Cut out a section of an image file\n *\n * @typedef {Object} ImageSection - Object with data to only display a section of an image\n * @property {number} sourceWidth Width in pixels to select from image, starting from the sourceLeft, going right\n * @property {number} sourceHeight Height in pixels to select from image, starting from the sourceTop, going down\n * @property {number} sourceLeft Leftmost pixel to select from image\n * @property {number} sourceTop Topmost pixel to select from image\n *\n */\nexport type ImageSection = {\n  sourceWidth: number\n  sourceHeight: number\n  sourceLeft?: number\n  sourceTop?: number\n}\n\n/**\n *\n *\n * @typedef {Object} ImageData - Object with data for displaying an image\n * @property {string} path Path to the image file.\n * @property {number} offsetX Offset on X, relative to the normal position of the image.\n * @property {number} offsetY Offset on Y, relative to the normal position of the image.\n * @property {number} height The height to show the image onscreen.\n * @property {number} width The width to show the image onscreen.\n * @property {ImageSection} section Use only a section of the image file, useful when arranging multiple icons into an image atlas. This field takes an `ImageSection` object, specifying `sourceWidth` and `sourceHeight`, and optionally also `sourceLeft` and `sourceTop`.\n *\n */\nexport type ImageData = {\n  path: string\n  offsetX?: number\n  offsetY?: number\n  height?: number\n  width?: number\n  section?: ImageSection\n}\n\nexport enum NPCState {\n  STANDING = 'standing',\n  TALKING = 'talking',\n  FOLLOWPATH = 'followPath'\n  //FOLLOWPLAYER = 'followPlayer'\n}\n\n\nexport enum NPCLerpType {\n  SMOOTH_PATH = 'smooth', //will follow the path but can cut sharp corners\n  RIGID_PATH = 'rigid', //will ensure each corner is hit\n}\n","import { ImageSection } from '../utils/types'\n\nexport function setSection(image: UIImage, section: ImageSection) {\n  image.sourceWidth = section.sourceWidth\n  image.sourceHeight = section.sourceHeight\n  image.sourceLeft = section.sourceLeft ? section.sourceLeft : 0\n  image.sourceTop = section.sourceTop ? section.sourceTop : 0\n}\n\nexport function buttonIconPos(textLen: number) {\n  let pos = -10 - textLen * 4\n  return pos > -65 ? pos : -65\n}\n\nexport default {\n  buttons: {\n    buttonE: {\n      sourceWidth: 174,\n      sourceHeight: 46,\n      sourceLeft: 512,\n      sourceTop: 662\n    },\n    buttonF: {\n      sourceWidth: 174,\n      sourceHeight: 46,\n      sourceLeft: 512,\n      sourceTop: 612\n    },\n    white: {\n      sourceWidth: 174,\n      sourceHeight: 46,\n      sourceLeft: 698,\n      sourceTop: 662\n    },\n    buttonRed: {\n      sourceWidth: 174,\n      sourceHeight: 46,\n      sourceLeft: 512,\n      sourceTop: 662\n    },\n    buttonDark: {\n      sourceWidth: 174,\n      sourceHeight: 46,\n      sourceLeft: 512,\n      sourceTop: 612\n    },\n    roundBlack: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 512,\n      sourceTop: 458\n    },\n    squareBlack: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 646,\n      sourceTop: 457\n    },\n    roundWhite: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 512,\n      sourceTop: 494\n    },\n    squareWhite: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 646,\n      sourceTop: 493\n    },\n    roundSilver: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 512,\n      sourceTop: 531\n    },\n    squareSilver: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 646,\n      sourceTop: 531\n    },\n    roundGold: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 512,\n      sourceTop: 567\n    },\n    squareGold: {\n      sourceWidth: 128,\n      sourceHeight: 32,\n      sourceLeft: 646,\n      sourceTop: 567\n    }\n  },\n  buttonLabels: {\n    E: {\n      sourceWidth: 26,\n      sourceHeight: 26,\n      sourceLeft: 697,\n      sourceTop: 611\n    },\n    F: {\n      sourceWidth: 26,\n      sourceHeight: 26,\n      sourceLeft: 733,\n      sourceTop: 611\n    },\n    EBlack: {\n      sourceWidth: 26,\n      sourceHeight: 26,\n      sourceLeft: 766,\n      sourceTop: 611\n    },\n    FBlack: {\n      sourceWidth: 26,\n      sourceHeight: 26,\n      sourceLeft: 802,\n      sourceTop: 611\n    }\n  },\n  backgrounds: {\n    promptBackground: {\n      sourceWidth: 416,\n      sourceHeight: 352,\n      sourceLeft: 501,\n      sourceTop: 12\n    },\n    promptLargeBackground: {\n      sourceWidth: 480,\n      sourceHeight: 384,\n      sourceLeft: 7,\n      sourceTop: 12\n    },\n    promptSlantedBackground: {\n      sourceWidth: 486,\n      sourceHeight: 326,\n      sourceLeft: 7,\n      sourceTop: 413\n    },\n    NPCDialog: {\n      sourceWidth: 766,\n      sourceHeight: 248,\n      sourceLeft: 22,\n      sourceTop: 756\n    }\n  },\n  icons: {\n    closeW: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 942,\n      sourceTop: 306\n    },\n    closeD: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 986,\n      sourceTop: 306\n    },\n    closeWLarge: {\n      sourceWidth: 64,\n      sourceHeight: 64,\n      sourceLeft: 512,\n      sourceTop: 381\n    },\n    closeDLarge: {\n      sourceWidth: 64,\n      sourceHeight: 64,\n      sourceLeft: 583,\n      sourceTop: 381\n    },\n    closeWNoBack: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 946,\n      sourceTop: 252\n    },\n    closeDNoBack: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 946,\n      sourceTop: 214\n    },\n    closeWNoBackLarge: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 214\n    },\n    closeDNoBackLarge: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 260\n    },\n    FDark: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 950,\n      sourceTop: 4\n    },\n    FWhite: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 4\n    },\n    EDark: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 950,\n      sourceTop: 40\n    },\n    EWhite: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 40\n    },\n    Timer: {\n      sourceWidth: 24,\n      sourceHeight: 32.2,\n      sourceLeft: 718,\n      sourceTop: 388\n    },\n    TimerLarge: {\n      sourceWidth: 48,\n      sourceHeight: 68,\n      sourceLeft: 662,\n      sourceTop: 386\n    },\n    ClickWhite: {\n      sourceWidth: 32,\n      sourceHeight: 48,\n      sourceLeft: 799,\n      sourceTop: 389\n    },\n    ClickDark: {\n      sourceWidth: 32,\n      sourceHeight: 48,\n      sourceLeft: 757,\n      sourceTop: 389\n    }\n  },\n  checkboxes: {\n    wOff: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 987,\n      sourceTop: 76\n    },\n    wOn: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 987,\n      sourceTop: 104\n    },\n    dOff: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 958,\n      sourceTop: 76\n    },\n    dOn: {\n      sourceWidth: 24,\n      sourceHeight: 24,\n      sourceLeft: 958,\n      sourceTop: 104\n    },\n    wLargeOff: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 132\n    },\n    wLargeOn: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 987,\n      sourceTop: 168\n    },\n    dLargeOff: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 950,\n      sourceTop: 132\n    },\n    dLargeOn: {\n      sourceWidth: 32,\n      sourceHeight: 32,\n      sourceLeft: 950,\n      sourceTop: 168\n    }\n  },\n  switches: {\n    roundOff: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 783,\n      sourceTop: 454\n    },\n    roundRed: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 853,\n      sourceTop: 454\n    },\n    roundGreen: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 923,\n      sourceTop: 454\n    },\n    squareOff: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 783,\n      sourceTop: 501\n    },\n    squareRed: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 852,\n      sourceTop: 501\n    },\n    squareGreen: {\n      sourceWidth: 64,\n      sourceHeight: 32,\n      sourceLeft: 921,\n      sourceTop: 501\n    }\n  },\n  bubbles: {\n    short: {\n      sourceWidth: 116 * 2,\n      sourceHeight: 84 * 2,\n      sourceLeft: 305 * 2,\n      sourceTop: 417 * 2,\n    },\n    normal: {\n      sourceWidth: 286 * 2,\n      sourceHeight: 84 * 2,\n      sourceLeft: 8 * 2,\n      sourceTop: 417 * 2,\n    },\n    long: {\n      sourceWidth: 497 * 2,\n      sourceHeight: 153 * 2,\n      sourceLeft: 6 * 2,\n      sourceTop: 254 * 2,\n    },\n    huge: {\n      sourceWidth: 497 * 2,\n      sourceHeight: 239 * 2,\n      sourceLeft: 6 * 2,\n      sourceTop: 7 * 2,\n    },\n  },\n}\n","export interface ITimerComponent {\n  elapsedTime: number\n  targetTime: number\n  onTargetTimeReached: (ownerEntity: IEntity) => void\n}\n\n/**\n * Execute once after X milliseconds\n */\n@Component('npcTimerDelay')\nexport class NPCDelay implements ITimerComponent {\n  elapsedTime: number\n  targetTime: number\n  onTargetTimeReached: (ownerEntity: IEntity) => void\n\n  private onTimeReachedCallback: () => void\n\n  /**\n   * @param seconds amount of time in seconds\n   * @param onTimeReachedCallback callback for when time is reached\n   */\n  constructor(seconds: number, onTimeReachedCallback: () => void) {\n    NPCTimerSystem.createAndAddToEngine()\n\n    this.elapsedTime = 0\n    this.targetTime = seconds\n    this.onTimeReachedCallback = onTimeReachedCallback\n    this.onTargetTimeReached = entity => {\n      this.onTimeReachedCallback()\n      entity.removeComponent(NPCDelay)\n    }\n  }\n\n  setCallback(onTimeReachedCallback: () => void) {\n    this.onTimeReachedCallback = onTimeReachedCallback\n  }\n}\n\nconst entitiesWithDelay = engine.getComponentGroup(NPCDelay)\n\nexport class NPCTimerSystem implements ISystem {\n  private static _instance: NPCTimerSystem | null = null\n\n  static createAndAddToEngine(): NPCTimerSystem {\n    if (this._instance == null) {\n      this._instance = new NPCTimerSystem()\n      engine.addSystem(this._instance)\n    }\n    return this._instance\n  }\n\n  private constructor() {\n    NPCTimerSystem._instance = this\n  }\n\n  update(dt: number) {\n    for (let ent of entitiesWithDelay.entities) {\n      let timerComponent = ent.getComponent(NPCDelay)\n\n      timerComponent.elapsedTime += dt\n\n      if (timerComponent.elapsedTime >= timerComponent.targetTime) {\n        timerComponent.onTargetTimeReached(ent)\n      }\n    }\n  }\n}\n","import {\n  canvas,\n  SFFont,\n  lightTheme,\n  darkTheme,\n  SFHeavyFont\n} from './../utils/default-ui-components'\nimport { ImageData, Dialog, ButtonStyles } from '../utils/types'\nimport resources, { setSection, buttonIconPos } from './resources'\nimport { NPCDelay } from '../utils/timerComponents'\n\nexport enum ConfirmMode {\n  Confirm = 0,\n  Cancel = 1,\n  Next = 2,\n  Button3 = 3,\n  Button4 = 4\n}\n\nexport let UIscaleMultiplier = 0.75\n\nlet portraitXPos = -350 * UIscaleMultiplier \nlet portraitYPos = 0 * UIscaleMultiplier\n\nlet imageXPos = 350 * UIscaleMultiplier\nlet imageYPos = 50 * UIscaleMultiplier\n\nlet portraitScale = 256 * UIscaleMultiplier \nlet imageScale = 256 * UIscaleMultiplier \n\nlet textSize = 24 * UIscaleMultiplier\nlet textYPos = 10 * UIscaleMultiplier\n\nlet buttonWidth = 174* UIscaleMultiplier\nlet buttonHeight = 46* UIscaleMultiplier\n\n\nlet buttonTextSize = 20 * UIscaleMultiplier\n\nlet button1XPos = 150 * UIscaleMultiplier\nlet button2XPos = -80 * UIscaleMultiplier\nlet button3XPos = -80 * UIscaleMultiplier\nlet button4XPos = 150 * UIscaleMultiplier\n\nlet button1YPos = -65 * UIscaleMultiplier\nlet button2YPos = -65 * UIscaleMultiplier\nlet button1YPos4 = -20 * UIscaleMultiplier\nlet button2YPos4 = -20 * UIscaleMultiplier\nlet button3YPos = -80 * UIscaleMultiplier\nlet button4YPos = -80 * UIscaleMultiplier\n\nlet skipButtonXPos = -300 * UIscaleMultiplier\nlet skipButtonYPos = -100 * UIscaleMultiplier\n\nlet buttonIconWidth = 26 * UIscaleMultiplier\nlet buttonIconHeight = 26 * UIscaleMultiplier\n\n/**\n * Displays a UI screen with text from an array of Dialog objects. Each entry can also include a portrait image, questions with triggered actions by each, etc.\n *\n * @param defaultPortrait ImageData object with soruce and dimension of default portrait image to use on the Dialog UI\n * @param useDarkTheme If true, use the dark theme for all the UI. Can also be an alternative `Texture` object to use a different themed atlas, with identical coordinates for each element.\n * @param sound Path to a sound file to play once for every dialog window shown.\n *\n */\nexport class DialogWindow {\n  public NPCScript: Dialog[] = []\n  private defaultPortrait: ImageData | null\n  public container: UIContainerRect\n  public panel: UIImage\n  public portrait: UIImage\n  public defaultPortraitTexture: Texture\n  public image: UIImage\n  public text: UIText\n  public fillInBox: UIInputText\n  public button1: CustomDialogButton\n  public button2: CustomDialogButton\n  public button3: CustomDialogButton\n  public button4: CustomDialogButton\n  public skipButton: CustomDialogButton\n\n  public leftClickIcon: UIImage\n  public isDialogOpen: boolean = false\n  public isQuestionPanel: boolean = false\n  public isFixedScreen: boolean = false\n  public activeTextId: number = 0\n  public uiTheme: Texture\n  private UIOpenTime: number = 0\n  public soundEnt: Entity\n  public defaultSound: string | null = null\n\n  canvas: UICanvas = canvas\n  ClickAction: null | (() => false | Subscription[]| void) = null\n  EButtonAction: null | (() => false | Subscription[]|void) = null\n  FButtonAction: null | (() => false | Subscription[]|void) = null\n\n  constructor(\n    defaultPortrait?: ImageData,\n    useDarkTheme?: boolean,\n    sound?: string,\n    customTheme?: Texture\n  ) {\n    this.defaultPortrait = defaultPortrait ? defaultPortrait : null\n\n    if (customTheme) {\n      this.uiTheme = customTheme\n    } else {\n      this.uiTheme = useDarkTheme ? darkTheme : lightTheme\n    }\n\n    // Container\n    this.container = new UIContainerRect(canvas)\n    //this.container.adaptWidth = true\n    this.container.width = '100%'\n    this.container.vAlign = 'bottom'\n    this.container.positionY = 140* UIscaleMultiplier\n    this.container.visible = false\n\n    // Text Panel\n    this.panel = new UIImage(this.container, this.uiTheme)\n    setSection(this.panel, resources.backgrounds.NPCDialog)\n    this.panel.width = 766  * UIscaleMultiplier\n    this.panel.height = 248 * UIscaleMultiplier\n    this.panel.onClick = new OnClick((): void => {\n      this.confirmText(ConfirmMode.Next)\n    })\n\n    this.defaultPortraitTexture = new Texture(\n      defaultPortrait ? defaultPortrait.path : this.uiTheme.src\n    )\n\n    // Portrait\n    this.portrait = new UIImage(this.container, this.defaultPortraitTexture)\n\n    this.portrait.sourceWidth =\n      defaultPortrait && defaultPortrait.section ? defaultPortrait.section.sourceWidth : 256 \n    this.portrait.sourceHeight =\n      defaultPortrait && defaultPortrait.section ? defaultPortrait.section.sourceHeight : 256\n    this.portrait.width = defaultPortrait && defaultPortrait.width ? defaultPortrait.width * UIscaleMultiplier : portraitScale\n    this.portrait.height = defaultPortrait && defaultPortrait.height ? defaultPortrait.height * UIscaleMultiplier : portraitScale\n    this.portrait.positionX =\n      defaultPortrait && defaultPortrait.offsetX\n        ? defaultPortrait.offsetX * UIscaleMultiplier + portraitXPos\n        : portraitXPos\n    this.portrait.positionY =\n      defaultPortrait && defaultPortrait.offsetY\n        ? defaultPortrait.offsetY * UIscaleMultiplier + portraitYPos\n        : portraitYPos\n    this.portrait.onClick = new OnClick((): void => {\n      this.confirmText(ConfirmMode.Next)\n    })\n\n    // Image\n    this.image = new UIImage(this.container, new Texture(this.uiTheme.src))\n\n    this.image.sourceWidth = 256\n    this.image.sourceHeight = 256\n    this.image.sourceTop = 0\n    this.image.sourceLeft = 0\n    this.image.width = imageScale\n    this.image.height = imageScale\n    this.image.positionX = imageXPos\n    this.image.positionY = imageYPos\n    this.image.onClick = new OnClick((): void => {\n      this.confirmText(ConfirmMode.Next)\n    })\n\n    // Dialog Text\n    this.text = new UIText(this.container)\n    this.text.visible=false;\n    this.text.adaptWidth = false\n    this.text.textWrapping = true\n    this.text.width = 460 * UIscaleMultiplier\n    this.text.positionX = 40 * UIscaleMultiplier\n    this.text.hAlign = 'center'\n    this.text.vAlign = 'center'\n    this.text.font = SFHeavyFont\n    this.text.fontSize = textSize\n    //this.text.hTextAlign = 'center'\n\tthis.text.hTextAlign = 'left'\n    this.text.vTextAlign = 'center'\n    this.text.positionY = textYPos\n\n    //this.text.fontWeight = 'normal'\n    this.text.color = useDarkTheme ? Color4.White() : Color4.Black()\n    this.text.isPointerBlocker = false\n\n    //  Input Text\n    this.fillInBox = new UIInputText(this.container)\n    this.fillInBox.visible=false;\n    this.fillInBox.textWrapping = true\n    this.fillInBox.width = 460 * UIscaleMultiplier\n    this.fillInBox.height = 40 * UIscaleMultiplier\n    this.fillInBox.hTextAlign = 'center'\n    this.fillInBox.vTextAlign = 'center'\n    this.fillInBox.font = SFHeavyFont\n    this.fillInBox.fontSize = textSize\n    this.fillInBox.hTextAlign = 'left'\n    this.fillInBox.vTextAlign = 'center'\n    this.fillInBox.positionY = textYPos\n    this.fillInBox.color = useDarkTheme ? Color4.White() : Color4.Black()\n    this.fillInBox.placeholder = \"?\"\n    this.fillInBox.isPointerBlocker = true\n\n    this.soundEnt = new Entity()\n    this.soundEnt.addComponent(new Transform())\n    engine.addEntity(this.soundEnt)\n    this.soundEnt.setParent(Attachable.AVATAR)\n\n    if (sound) {\n      this.soundEnt.addComponent(new AudioSource(new AudioClip(sound)))\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n\n      this.defaultSound = sound\n    }\n\n    this.button1 = new CustomDialogButton(\n      this.container,\n      this.uiTheme,\n      'yes',\n      button1XPos,\n      button1YPos,\n      () => {\n        this.confirmText(ConfirmMode.Confirm)\n      },\n      useDarkTheme? true: false,\n      ButtonStyles.E\n    )\n    this.button1.hide()\n\n    this.button2 = new CustomDialogButton(\n      this.container,\n      this.uiTheme,\n      'no',\n      button2XPos,\n      button2YPos,\n      () => {\n        this.confirmText(ConfirmMode.Cancel)\n      },\n      useDarkTheme? true: false,\n      ButtonStyles.F\n    )\n    this.button2.hide()\n\n    this.button3 = new CustomDialogButton(\n      this.container,\n      this.uiTheme,\n      'maybe',\n      button3XPos,\n      button3YPos,\n      () => {\n        this.confirmText(ConfirmMode.Button3)\n      },\n      useDarkTheme? true: false,\n      ButtonStyles.DARK\n    )\n    this.button3.hide()\n\n    this.button4 = new CustomDialogButton(\n      this.container,\n      this.uiTheme,\n      'maybe',\n      button4XPos,\n      button4YPos,\n      () => {\n        this.confirmText(ConfirmMode.Button4)\n      },\n      useDarkTheme? true: false,\n      ButtonStyles.DARK\n    )\n    this.button4.hide()\n\n    this.skipButton = new CustomDialogButton(\n      this.container,\n      this.uiTheme,\n      'Skip',\n      skipButtonXPos,\n      skipButtonYPos,\n      () => {\n        this.skipDialogs()\n      },\n      false,\n      darkTheme ? ButtonStyles.WHITE : ButtonStyles.F\n    )\n    this.skipButton.image.width = 80 * UIscaleMultiplier\n    this.skipButton.image.height = 30 * UIscaleMultiplier\n\tthis.skipButton.label.hTextAlign = 'left'\n    this.skipButton.label.fontSize = 12 * UIscaleMultiplier\n    this.skipButton.label.positionX = 40 * UIscaleMultiplier\n    this.skipButton.label.font = SFHeavyFont\n    this.skipButton.icon.height = 20 * UIscaleMultiplier\n    this.skipButton.icon.width = 20 * UIscaleMultiplier\n    this.skipButton.icon.positionX = -20 * UIscaleMultiplier\n    this.skipButton.hide()\n\n    // Left Click Icon\n    this.leftClickIcon = new UIImage(this.container, this.uiTheme)\n    this.leftClickIcon.width = 32 * UIscaleMultiplier\n    this.leftClickIcon.height = 48 * UIscaleMultiplier\n    this.leftClickIcon.positionX = 340 * UIscaleMultiplier\n    this.leftClickIcon.positionY = -80 * UIscaleMultiplier\n    this.leftClickIcon.visible = false\n    setSection(\n      this.leftClickIcon,\n      useDarkTheme ? resources.icons.ClickDark : resources.icons.ClickWhite\n    )\n\n    DialogTypeInSystem.createAndAddToEngine()\n  }\n\n  /**\n   * Opens a dialog UI to start a conversation.\n   * @param {Dialog[]} NPCScript  Instructions to follow during the conversation\n   * @param {number|string} textId Where to start in the script. Can refer to an index in the array or the `name` field of a Dialog entry.\n   */\n  public openDialogWindow(NPCScript: Dialog[], textId?: number | string): void {\n    this.UIOpenTime = +Date.now()\n\n    this.NPCScript = NPCScript\n\n    if (!textId) {\n      this.activeTextId = 0\n    } else if (typeof textId === 'number') {\n      this.activeTextId = textId\n    } else {\n      this.activeTextId = findDialogByName(NPCScript, textId)\n    }\n\n    let currentText: Dialog = NPCScript[this.activeTextId]\n      ? NPCScript[this.activeTextId]\n      : { text: '' }\n\n    if (currentText.audio) {\n      this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(currentText.audio)))\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    } else if (this.defaultSound) {\n      this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound)))\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    }\n\n    // Set portrait\n\n    if (currentText.portrait) {\n      this.portrait.source = new Texture(currentText.portrait.path)\n\n      this.portrait.positionX = currentText.portrait.offsetX\n        ? currentText.portrait.offsetX * UIscaleMultiplier + portraitXPos\n        : portraitXPos\n\n      this.portrait.positionY = currentText.portrait.offsetY\n        ? currentText.portrait.offsetY * UIscaleMultiplier + portraitYPos\n        : portraitYPos\n\n      this.portrait.width = currentText.portrait.width ? currentText.portrait.width * UIscaleMultiplier : portraitScale\n\n      this.portrait.height = currentText.portrait.height ? currentText.portrait.height * UIscaleMultiplier : portraitScale\n\n      if (currentText.portrait.section) {\n        setSection(this.portrait, currentText.portrait.section)\n      }\n      this.portrait.visible = true\n    } else if (this.defaultPortrait) {\n      this.portrait.source = this.defaultPortraitTexture\n\n      this.portrait.positionX =\n        this.defaultPortrait && this.defaultPortrait.offsetX\n          ? this.defaultPortrait.offsetX * UIscaleMultiplier + portraitXPos\n          : portraitXPos\n      this.portrait.positionY =\n        this.defaultPortrait && this.defaultPortrait.offsetY\n          ? this.defaultPortrait.offsetY * UIscaleMultiplier + portraitYPos\n          : portraitYPos\n      this.portrait.width =\n        this.defaultPortrait && this.defaultPortrait.width ? this.defaultPortrait.width * UIscaleMultiplier : portraitScale\n      this.portrait.height =\n        this.defaultPortrait && this.defaultPortrait.height ? this.defaultPortrait.height * UIscaleMultiplier : portraitScale\n\n      if (this.defaultPortrait.section) {\n        setSection(this.portrait, this.defaultPortrait.section)\n      }\n      this.portrait.visible = true\n    } else {\n      log('No portrait')\n      this.portrait.visible = false\n    }\n\n    // Set image on the right\n    if (currentText.image) {\n      let image: ImageData = currentText.image\n      log('setting image to ', image.path)\n      this.image.source = new Texture(image.path)\n\n      this.image.positionX = image.offsetX ? image.offsetX * UIscaleMultiplier + imageXPos : imageXPos\n      this.image.positionY = image.offsetY ? image.offsetY * UIscaleMultiplier + imageYPos : imageYPos\n\n      this.image.width = image.width ? image.width * UIscaleMultiplier : imageScale\n      this.portrait.height = image.height ? image.height * UIscaleMultiplier : imageScale\n\n      if (image.section) {\n        setSection(this.image, image.section)\n      }\n      this.image.visible = true\n    } else {\n      this.image.visible = false\n    }\n\n\n    if(currentText.isQuestion && currentText.isEntryQuestion){\n      this.fillInBox.fontSize = currentText.fontSize ? currentText.fontSize * UIscaleMultiplier : textSize\n      this.fillInBox.positionY = currentText.offsetY ? currentText.offsetY * UIscaleMultiplier + textYPos : textYPos\n      this.fillInBox.positionX = currentText.offsetX ? currentText.offsetX * UIscaleMultiplier : 0\n      this.fillInBox.visible = true\n      this.container.visible = true\n    }\n    else{\n      // Set text\n      //this.text.value = currentText.text\n      this.text.fontSize = currentText.fontSize ? currentText.fontSize * UIscaleMultiplier : textSize\n      this.text.positionY = currentText.offsetY ? currentText.offsetY * UIscaleMultiplier + textYPos : textYPos\n      this.text.positionX = currentText.offsetX ? currentText.offsetX * UIscaleMultiplier : 0\n      this.text.visible = true\n      this.container.visible = true\n\n      DialogTypeInSystem._instance!.newText(\n        this,\n        currentText.text,\n        this.activeTextId,\n        currentText.typeSpeed ? currentText.typeSpeed : undefined\n      )\n    }\n    \n\n    // Global button events\n    if (!this.ClickAction) {\n      this.ClickAction = Input.instance.subscribe('BUTTON_DOWN', ActionButton.POINTER, false, e => {\n        if (!this.isDialogOpen || +Date.now() - this.UIOpenTime < 100) return\n\n        if (currentText.isQuestion && currentText.isEntryQuestion) return\n\n        if (!DialogTypeInSystem._instance!.done) {\n          DialogTypeInSystem._instance!.rush()\n          return\n        } else if (!this.isQuestionPanel && !this.isFixedScreen) {\n          this.confirmText(ConfirmMode.Next)\n        }\n      })\n\n      this.EButtonAction = Input.instance.subscribe(\n        'BUTTON_DOWN',\n        ActionButton.PRIMARY,\n        false,\n        e => {\n\t\t  if (!this.isDialogOpen || +Date.now() - this.UIOpenTime < 100) return\n\n          if (this.isQuestionPanel) {\n            this.confirmText(ConfirmMode.Confirm)\n          } else if (!this.isQuestionPanel && !this.isFixedScreen) {\n\t\t\t      this.confirmText(ConfirmMode.Next)\n\t\t      }\n        }\n      )\n      \n      this.FButtonAction = Input.instance.subscribe(\n        'BUTTON_DOWN',\n        ActionButton.SECONDARY,\n        false,\n        e => {\n\t\t  if (!this.isDialogOpen || +Date.now() - this.UIOpenTime < 100) return\n\n          if (\n            this.isQuestionPanel\n          ) {\n            this.confirmText(ConfirmMode.Cancel)\n          } else if (\n            currentText.skipable && !this.isFixedScreen\n          ) {\n            this.skipDialogs()\n          }\n        }\n      )\n    }\n\n    this.layoutDialogWindow(this.activeTextId)\n    this.isDialogOpen = true\n  }\n\n  // Progresses text\n  public confirmText(mode: ConfirmMode): void {\n    let currentText = this.NPCScript[this.activeTextId]\n\t  this.UIOpenTime = +Date.now()\n\n    // Update active text\n    if (mode == ConfirmMode.Next) {\n      if (!currentText.isQuestion) {\n        if (currentText.triggeredByNext) {\n          currentText.triggeredByNext()\n        }\n        if (currentText.isEndOfDialog) {\n          this.closeDialogWindow()\n          return\n        }\n        this.activeTextId++\n      }\n    }\n\n    if (mode == ConfirmMode.Confirm) {\n      if (currentText.buttons && currentText.buttons.length >= 1) {\n        if (typeof currentText.buttons[0].goToDialog === 'number') {\n          this.activeTextId = currentText.buttons[0].goToDialog\n        } else {\n          this.activeTextId = findDialogByName(this.NPCScript, currentText.buttons[0].goToDialog)\n        }\n        if (currentText.buttons[0].triggeredActions) {\n          const fillInBoxTextValue = currentText.isEntryQuestion ? this.fillInBox.value : undefined; \n          currentText.buttons[0].triggeredActions(fillInBoxTextValue)\n        }\n      }\n    }\n\n    if (mode == ConfirmMode.Cancel) {\n      if (currentText.buttons && currentText.buttons.length >= 2) {\n        if (typeof currentText.buttons[1].goToDialog === 'number') {\n          this.activeTextId = currentText.buttons[1].goToDialog\n        } else {\n          this.activeTextId = findDialogByName(this.NPCScript, currentText.buttons[1].goToDialog)\n        }\n        if (currentText.buttons[1].triggeredActions) {\n          const fillInBoxTextValue = currentText.isEntryQuestion ? this.fillInBox.value : undefined; \n          currentText.buttons[1].triggeredActions(fillInBoxTextValue)\n        }\n      }\n    }\n\n    if (mode == ConfirmMode.Button3) {\n      if (currentText.buttons && currentText.buttons.length >= 3) {\n        if (typeof currentText.buttons[2].goToDialog === 'number') {\n          this.activeTextId = currentText.buttons[2].goToDialog\n        } else {\n          this.activeTextId = findDialogByName(this.NPCScript, currentText.buttons[2].goToDialog)\n        }\n        if (currentText.buttons[2].triggeredActions) {\n          const fillInBoxTextValue = currentText.isEntryQuestion ? this.fillInBox.value : undefined; \n          currentText.buttons[2].triggeredActions(fillInBoxTextValue)\n        }\n      }\n    }\n\n    if (mode == ConfirmMode.Button4) {\n      if (currentText.buttons && currentText.buttons.length >= 4) {\n        if (typeof currentText.buttons[3].goToDialog === 'number') {\n          this.activeTextId = currentText.buttons[3].goToDialog\n        } else {\n          this.activeTextId = findDialogByName(this.NPCScript, currentText.buttons[3].goToDialog)\n        }\n        if (currentText.buttons[3].triggeredActions) {\n          const fillInBoxTextValue = currentText.isEntryQuestion ? this.fillInBox.value : undefined; \n          currentText.buttons[3].triggeredActions(fillInBoxTextValue)\n        }\n      }\n    }\n    // Update active text with new active text\n    currentText = this.NPCScript[this.activeTextId]\n\n    if(currentText.isQuestion && currentText.isEntryQuestion){\n      this.text.visible = false;\n      this.fillInBox.value = \"\";\n      this.fillInBox.visible = true;\n      // Buttons & action icons\n      this.layoutDialogWindow(this.activeTextId)\n    }\n    else{\n      this.fillInBox.visible = false;\n      this.text.visible = true;\n      DialogTypeInSystem._instance!.newText(\n        this,\n        currentText.text,\n        this.activeTextId,\n        currentText.typeSpeed ? currentText.typeSpeed : undefined\n      )\n    }\n   \n  }\n\n  // Adds the buttons or mouse icon depending on the type of window\n  public layoutDialogWindow(textId: number): void {\n    let currentText: Dialog = this.NPCScript[textId] ? this.NPCScript[textId] : { text: '' }\n\n    // Update text\n    let textY = currentText.offsetY ? currentText.offsetY * UIscaleMultiplier + textYPos : textYPos\n\n    if (currentText.buttons && currentText.buttons.length >= 3) {\n      textY += 50 *  UIscaleMultiplier\n    } else if (currentText.buttons && currentText.buttons.length >= 1) {\n      textY += 24 * UIscaleMultiplier\n    }\n\n    this.text.fontSize = currentText.fontSize ? currentText.fontSize * UIscaleMultiplier : textSize\n    this.text.positionY = textY\n\n    if (currentText.audio) {\n      this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(currentText.audio)))\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    } else if (this.defaultSound) {\n      this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound)))\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    }\n\n    if (currentText.portrait) {\n      this.portrait.source = new Texture(currentText.portrait.path)\n\n      this.portrait.positionX = currentText.portrait.offsetX\n        ? currentText.portrait.offsetX * UIscaleMultiplier+ portraitXPos\n        : portraitXPos\n\n      this.portrait.positionY = currentText.portrait.offsetY\n        ? currentText.portrait.offsetY* UIscaleMultiplier + portraitYPos\n        : portraitYPos\n\n      this.portrait.width = currentText.portrait.width ? currentText.portrait.width * UIscaleMultiplier: portraitScale\n\n      this.portrait.height = currentText.portrait.height ? currentText.portrait.height * UIscaleMultiplier: portraitScale\n\n      if (currentText.portrait.section) {\n        setSection(this.portrait, currentText.portrait.section)\n      }\n      this.portrait.visible = true\n    } else if (this.defaultPortrait) {\n      this.portrait.source = new Texture(this.defaultPortrait.path)\n\n      this.portrait.positionX =\n        this.defaultPortrait && this.defaultPortrait.offsetX\n          ? this.defaultPortrait.offsetX* UIscaleMultiplier + portraitXPos\n          : portraitXPos\n      this.portrait.positionY =\n        this.defaultPortrait && this.defaultPortrait.offsetY\n          ? this.defaultPortrait.offsetY* UIscaleMultiplier + portraitYPos\n          : portraitYPos\n\n      this.portrait.width =\n        this.defaultPortrait && this.defaultPortrait.width ? this.defaultPortrait.width * UIscaleMultiplier: portraitScale\n      this.portrait.height =\n        this.defaultPortrait && this.defaultPortrait.height ? this.defaultPortrait.height * UIscaleMultiplier: portraitScale\n\n      if (this.defaultPortrait.section) {\n        setSection(this.portrait, this.defaultPortrait.section)\n      }\n      this.portrait.visible = true\n    } else {\n      log('No portrait')\n      this.portrait.visible = false\n    }\n\n    this.image.visible = false\n\n    // Set image on the right\n    if (currentText.image) {\n      let image: ImageData = currentText.image\n      log('setting image to ', image.path)\n      this.image.source = new Texture(image.path)\n\n      this.image.positionX = image.offsetX ? image.offsetX* UIscaleMultiplier + imageXPos : imageXPos\n      this.image.positionY = image.offsetY ? image.offsetY* UIscaleMultiplier + imageYPos : imageYPos\n\n      this.image.width = currentText.image.width ? currentText.image.width* UIscaleMultiplier : imageScale\n      this.image.height = currentText.image.height ? currentText.image.height* UIscaleMultiplier : imageScale\n\n      if (image.section) {\n        setSection(this.image, image.section)\n      }\n      this.image.visible = true\n    } else {\n      this.image.visible = false\n    }\n\n    this.isQuestionPanel = currentText.isQuestion ? currentText.isQuestion : false\n\n    this.isFixedScreen = currentText.isFixedScreen ? currentText.isFixedScreen : false\n    this.button1.hide()\n    this.button2.hide()\n    this.button3.hide()\n    this.button4.hide()\n\n    // Mouse icon\n    this.leftClickIcon.visible = false\n\n    if (currentText.isQuestion) {\n      this.skipButton.hide()\n      // Button E\n      if (currentText.buttons && currentText.buttons.length >= 1) {\n        this.button1.update(\n          currentText.buttons[0].label,\n          currentText.buttons[0].offsetX\n            ? currentText.buttons[0].offsetX * UIscaleMultiplier+ button1XPos\n            : button1XPos,\n          currentText.buttons.length >= 3\n            ? currentText.buttons[0].offsetY\n              ? currentText.buttons[0].offsetY* UIscaleMultiplier + button1YPos4\n              : button1YPos4\n            : currentText.buttons[0].offsetY\n            ? currentText.buttons[0].offsetY* UIscaleMultiplier + button1YPos\n            : button1YPos\n        )\n      }\n\n      // Button F\n      if (currentText.buttons && currentText.buttons.length >= 2) {\n        this.button2.update(\n          currentText.buttons[1].label,\n          currentText.buttons[1].offsetX* UIscaleMultiplier\n            ? currentText.buttons[1].offsetX* UIscaleMultiplier + button2XPos\n            : button2XPos,\n          currentText.buttons.length >= 3\n            ? currentText.buttons[1].offsetY* UIscaleMultiplier\n              ? currentText.buttons[1].offsetY* UIscaleMultiplier + button2YPos4\n              : button2YPos4\n            : currentText.buttons[1].offsetY* UIscaleMultiplier\n            ? currentText.buttons[1].offsetY* UIscaleMultiplier + button2YPos\n            : button2YPos\n        )\n      }\n\n      // Button 3\n      if (currentText.buttons && currentText.buttons.length >= 3) {\n        this.button3.update(\n          currentText.buttons[2].label,\n          currentText.buttons[2].offsetX* UIscaleMultiplier\n            ? currentText.buttons[2].offsetX* UIscaleMultiplier + button3XPos\n            : button3XPos,\n          currentText.buttons[2].offsetY* UIscaleMultiplier\n            ? currentText.buttons[2].offsetY * UIscaleMultiplier+ button3YPos\n            : button3YPos\n        )\n      }\n\n      // Button 4\n      if (currentText.buttons && currentText.buttons.length >= 4) {\n        this.button4.update(\n          currentText.buttons[3].label,\n          currentText.buttons[3].offsetX* UIscaleMultiplier\n            ? currentText.buttons[3].offsetX* UIscaleMultiplier + button4XPos\n            : button4XPos,\n          currentText.buttons[3].offsetY* UIscaleMultiplier\n            ? currentText.buttons[3].offsetY* UIscaleMultiplier + button4YPos\n            : button4YPos\n        )\n      }\n\n      dummyQuestionDelays.addComponentOrReplace(\n        new NPCDelay(0.7, () => {\n          // Button E\n          if (currentText.buttons && currentText.buttons.length >= 1) {\n            this.button1.show()\n          }\n          // Button F\n          if (currentText.buttons && currentText.buttons.length >= 2) {\n            this.button2.show()\n          }\n\n          // Button 3\n          if (currentText.buttons && currentText.buttons.length >= 3) {\n            this.button3.show()\n          }\n\n          // Button 4\n          if (currentText.buttons && currentText.buttons.length >= 4) {\n            this.button4.show()\n          }\n        })\n      )\n    } else if (!this.isFixedScreen) {\n      this.leftClickIcon.visible = true\n\n      if (currentText.skipable) {\n        this.skipButton.show()\n      } else {\n        this.skipButton.hide()\n      }\n    }\n  }\n\n  /**\n   * Closes a dialog UI.\n   */\n  public closeDialogWindow(): void {\n    if (this.isDialogOpen) {\n      this.isDialogOpen = false\n\n      this.portrait.visible = false\n      this.text.value = ''\n      this.text.visible = false\n      this.fillInBox.value = ''\n      this.fillInBox.visible = false;\n      this.button1.hide()\n      this.button2.hide()\n      this.button3.hide()\n      this.button4.hide()\n      this.skipButton.hide()\n      this.leftClickIcon.visible = false\n      this.container.visible = false\n    }\n  }\n\n  public skipDialogs() {\n    if (!this.isDialogOpen || +Date.now() - this.UIOpenTime < 100) return\n\n    while (\n\t\tthis.NPCScript[this.activeTextId] &&\n      this.NPCScript[this.activeTextId].skipable &&\n      !this.NPCScript[this.activeTextId].isQuestion\n    ) {\n\t  if (this.NPCScript[this.activeTextId].triggeredByNext) {\n\t\t\tthis.NPCScript[this.activeTextId].triggeredByNext()\n\t  }\n     \n      if (\n        this.NPCScript[this.activeTextId].skipable &&\n        this.NPCScript[this.activeTextId].isEndOfDialog\n      ) {\n        this.closeDialogWindow()\n        return\n      }\n\t  this.activeTextId += 1\n    }\n    //this.activeTextId -= 1\n\n    this.confirmText(ConfirmMode.Next)\n  }\n}\n\nconst DEFAULT_SPEED = 45\n\nexport class DialogTypeInSystem implements ISystem {\n  static _instance: DialogTypeInSystem | null = null\n\n  timer: number = 0\n  speed: number = DEFAULT_SPEED\n  visibleChars: number = 0\n  fullText: string = ''\n  UIText: UIText | null = null\n  done: boolean = true\n\n  static createAndAddToEngine(): DialogTypeInSystem {\n    if (this._instance == null) {\n      this._instance = new DialogTypeInSystem()\n      engine.addSystem(this._instance)\n    }\n    return this._instance\n  }\n\n  private constructor() {\n    DialogTypeInSystem._instance = this\n  }\n\n  update(dt: number) {\n    if (this.done) return\n\n    this.timer += dt\n    if (this.timer >= 2 / this.speed) {\n      let charsToAdd = Math.floor(this.timer / (1 / this.speed))\n      this.timer = 0\n      this.visibleChars += charsToAdd\n      \n\t  // support <> tags\n\t  this.closeTag(charsToAdd)\n\n\t  if (this.visibleChars >= this.fullText.length) {\n        this.done = true\n        this.visibleChars = this.fullText.length\n\t  }\n\n      if (this.UIText) {\n        this.UIText.value = this.fullText.substr(0, this.visibleChars)\n      }\n    }\n  }\n\n  newText(dialog: DialogWindow, text: string, textId: number, speed?: number) {\n    this.timer = 0\n    this.done = false\n    this.UIText = dialog.text\n    this.fullText = text\n    this.visibleChars = 0\n\n    if (speed && speed <= 0) {\n      this.rush()\n    } else if (speed) {\n      this.speed = speed\n    } else {\n      this.speed = DEFAULT_SPEED\n    }\n\n    // Buttons & action icons\n    dialog.layoutDialogWindow(textId)\n  }\n  rush() {\n    this.done = true\n    this.timer = 0\n    this.visibleChars = this.fullText.length\n\n    if (this.UIText) {\n      this.UIText.value = this.fullText\n    }\n  }\n  closeTag(newChars: number){\n\t  if(this.visibleChars == 0 || newChars ==0 ) return\n\n\tlet openTag: boolean = false\n\tlet closeTag : boolean = false\n\tfor(let i = this.visibleChars-newChars; i < this.visibleChars ; i++){\n\t\t\n\t\tif(!openTag){\n\t\t\tif(this.fullText.substr(i, 1) == '<'){\n\t\t\t\topenTag= true\n\t\t\t\t\n\t\t\t}\n\t\t} else {\n\t\t\tif(this.fullText.substr(i, 1) == '>'){\n\t\t\t\tcloseTag= true\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!openTag || closeTag){\t\n\t\treturn\n\t}\n\n\twhile(this.visibleChars < this.fullText.length && this.fullText.substr(this.visibleChars-1, 1) != '>'){\n\t\tthis.visibleChars+=1\n\t}\n\treturn\n  }\n}\n\nexport class CustomDialogButton extends Entity {\n  label: UIText\n  image: UIImage\n  icon: UIImage | null = null\n  style: ButtonStyles | null\n  onClick: () => void\n  constructor(\n    parent: UIContainerRect,\n    texture: Texture,\n    //UIOpenTime: number,\n    label: string,\n    posX: number,\n    posY: number,\n    onClick: () => void,\n    useDarkTheme?: boolean,\n    style?: ButtonStyles\n  ) {\n    super()\n    this.image = new UIImage(parent, texture)\n    this.image.positionX = posX\n    this.image.positionY = posY\n    this.image.width = buttonWidth\n    this.image.height = buttonHeight\n\n    this.label = new UIText(this.image)\n    this.style = style ? style : null\n\n    this.onClick = onClick\n\n    if (this.style) {\n      switch (this.style) {\n        case ButtonStyles.E:\n          setSection(this.image, resources.buttons.buttonE)\n          this.label.positionX = 25 * UIscaleMultiplier\n\n          this.icon = new UIImage(this.image, useDarkTheme == true ? darkTheme : lightTheme)\n          this.icon.width = buttonIconWidth\n          this.icon.height = buttonIconHeight\n          // this.button1Icon.positionY = 15\n          this.icon.hAlign = 'center'\n          this.icon.vAlign = 'center'\n          this.icon.isPointerBlocker = false\n          setSection(this.icon, resources.buttonLabels.E)\n          this.icon.positionX = buttonIconPos(label.length)\n\n          break\n        case ButtonStyles.F:\n          setSection(this.image, resources.buttons.buttonF)\n          this.label.positionX = 25 * UIscaleMultiplier\n\n          this.icon = new UIImage(this.image, useDarkTheme == true ? darkTheme : lightTheme)\n          this.icon.width = buttonIconWidth\n          this.icon.height = buttonIconHeight\n          // this.button1Icon.positionY = 15\n          this.icon.hAlign = 'center'\n          this.icon.vAlign = 'center'\n          this.icon.isPointerBlocker = false\n          setSection(this.icon, resources.buttonLabels.F)\n          this.icon.positionX = buttonIconPos(label.length)\n          break\n\n        case ButtonStyles.WHITE:\n          setSection(this.image, resources.buttons.white)\n          this.label.positionX = 25 * UIscaleMultiplier\n\n          this.icon = new UIImage(this.image, useDarkTheme == true ? darkTheme : lightTheme)\n          this.icon.width = buttonIconWidth\n          this.icon.height = buttonIconHeight\n          // this.button1Icon.positionY = 15\n          this.icon.hAlign = 'center'\n          this.icon.vAlign = 'center'\n          this.icon.isPointerBlocker = false\n          setSection(this.icon, resources.buttonLabels.FBlack)\n          this.icon.positionX = buttonIconPos(label.length)\n          break\n\n        case ButtonStyles.RED:\n          setSection(this.image, resources.buttons.buttonRed)\n          break\n        case ButtonStyles.DARK:\n          setSection(this.image, resources.buttons.buttonDark)\n          break\n        case ButtonStyles.ROUNDBLACK:\n          setSection(this.image, resources.buttons.roundBlack)\n          break\n        case ButtonStyles.ROUNDWHITE:\n          setSection(this.image, resources.buttons.roundWhite)\n          break\n        case ButtonStyles.ROUNDSILVER:\n          setSection(this.image, resources.buttons.roundSilver)\n          break\n        case ButtonStyles.ROUNDGOLD:\n          setSection(this.image, resources.buttons.roundGold)\n          break\n        case ButtonStyles.SQUAREBLACK:\n          setSection(this.image, resources.buttons.squareBlack)\n          break\n        case ButtonStyles.SQUAREWHITE:\n          setSection(this.image, resources.buttons.squareWhite)\n          break\n        case ButtonStyles.SQUARESILVER:\n          setSection(this.image, resources.buttons.squareSilver)\n          break\n        case ButtonStyles.SQUAREGOLD:\n          setSection(this.image, resources.buttons.squareGold)\n          break\n      }\n    } else {\n      setSection(this.image, resources.buttons.roundSilver)\n    }\n\n    this.label.value = label\n    this.label.hTextAlign = 'center'\n    this.label.vTextAlign = 'center'\n    this.label.fontSize = buttonTextSize\n    this.label.font = SFFont\n    this.label.color =\n      style == ButtonStyles.ROUNDWHITE ||\n      style == ButtonStyles.SQUAREWHITE ||\n      style == ButtonStyles.WHITE\n        ? Color4.Black()\n        : Color4.White()\n    this.label.isPointerBlocker = false\n\n    this.image.onClick = new OnClick(() => {\n      this.onClick()\n    })\n\n    if (style == ButtonStyles.E) {\n      Input.instance.subscribe('BUTTON_DOWN', ActionButton.PRIMARY, false, e => {\n        if (this.image.visible) {\n          // && +Date.now() - UIOpenTime > 100) {\n          this.onClick()\n        }\n      })\n    } else if (style == ButtonStyles.F) {\n      Input.instance.subscribe('BUTTON_DOWN', ActionButton.SECONDARY, false, e => {\n        if (this.image.visible) {\n          // && +Date.now() - UIOpenTime > 100) {\n          this.onClick()\n        }\n      })\n    }\n  }\n\n  public hide(): void {\n    this.image.visible = false\n  }\n\n  public show(): void {\n    this.image.visible = true\n  }\n\n  public grayOut(): void {\n    this.label.color = Color4.Gray()\n    this.image.isPointerBlocker = false\n  }\n\n  public enable(): void {\n    this.label.color = Color4.White()\n    this.image.isPointerBlocker = true\n  }\n  public update(label: string, posX: number, posY: number) {\n    this.label.value = label\n    this.image.positionX = posX\n    this.image.positionY = posY\n\n    if (this.icon && (this.style == ButtonStyles.E || this.style == ButtonStyles.F)) {\n      this.icon.positionX = buttonIconPos(label.length)\n    }\n  }\n}\n\nlet dummyQuestionDelays = new Entity()\nengine.addEntity(dummyQuestionDelays)\n\nfunction findDialogByName(dialogs: Dialog[], name: string) {\n  for (let i = 0; i < dialogs.length; i++) {\n    if (dialogs[i].name && dialogs[i].name == name) {\n      return i\n    }\n  }\n  return 0\n}\n","import { TriggerData } from '../utils/types'\n\nexport class NPCTriggerSystem implements ISystem {\n  private static _instance: NPCTriggerSystem | null = null\n  static get instance(): NPCTriggerSystem {\n    return this.createAndAddToEngine()\n  }\n\n  private _triggers: Record<string, TriggerWrapper> = {}\n  private _cameraTriggerWrapper: CameraTrigger\n  private _componentGroup: ComponentGroup\n\n  private constructor() {\n    NPCTriggerSystem._instance = this\n    this._cameraTriggerWrapper = new CameraTrigger(\n      new TriggerBoxShape(new Vector3(0.5, 1.8, 0.5), new Vector3(0, 0.91, 0))\n    )\n\n    this._componentGroup = engine.getComponentGroup(NPCTriggerComponent)\n  }\n\n  static createAndAddToEngine(): NPCTriggerSystem {\n    if (this._instance == null) {\n      this._instance = new NPCTriggerSystem()\n      engine.addSystem(this._instance)\n    }\n    return this._instance\n  }\n\n  /**\n   * set a custom trigger's shape for the camera\n   * @param shape custom trigger's shape\n   */\n  setCameraTriggerShape(shape: TriggerBoxShape | TriggerSphereShape) {\n    this._cameraTriggerWrapper.setShape(shape)\n  }\n\n  update() {\n    let entitiesWithTriggers = this._componentGroup.entities\n\n    //iterate through all entities with triggers and wrap entities that weren't wrapped yet\n    entitiesWithTriggers.forEach(entity => {\n      if (this.shouldWrapTriggerEntity(entity)) {\n        this.wrapTriggerEntity(entity)\n      }\n    })\n\n    //iterate through wrapped entities\n    for (const key in this._triggers) {\n      if (this._triggers.hasOwnProperty(key)) {\n        let wrapper = this._triggers[key]\n\n        //update debug entity\n        if (wrapper.isDebugging()) {\n          wrapper.updateDebugEntity()\n        }\n\n        if (!wrapper.isInEngine()) {\n          //remove debugging\n          if (wrapper.isDebugging()) {\n            wrapper.removeDebugEntity()\n          }\n          //remove old collisions\n          NPCTriggerSystem.removeTriggerFromSystem(wrapper)\n          //remove from record\n          delete this._triggers[key]\n        } else if (wrapper.trigger != null && wrapper.trigger.enabled) {\n          //if was set as enabled in last frame\n          if (!wrapper.wasEnabled) {\n            if (wrapper.isDebugging()) {\n              wrapper.addDebugEntity()\n            }\n          }\n          //set as enabled\n          wrapper.wasEnabled = true\n\n          //check collision camera\n          if (wrapper.trigger.onCameraEnter || wrapper.trigger.onCameraExit) {\n            this.checkCollisionAgainstCamera(wrapper)\n          }\n\n          //check collision with others\n          if (wrapper.trigger.onTriggerEnter || wrapper.trigger.onTriggerExit) {\n            this.checkCollisionAgainstOtherTriggers(wrapper)\n          }\n        } else if (wrapper.wasEnabled) {\n          wrapper.wasEnabled = false\n          //remove debugging\n          if (wrapper.isDebugging()) {\n            wrapper.removeDebugEntity()\n          }\n          NPCTriggerSystem.removeTriggerFromSystem(wrapper)\n        }\n      }\n    }\n  }\n\n  private shouldWrapTriggerEntity(entity: IEntity): boolean {\n    return this._triggers[entity.uuid] == undefined || this._triggers[entity.uuid] == null\n  }\n\n  private wrapTriggerEntity(entity: IEntity) {\n    this._triggers[entity.uuid] = new TriggerWrapper(entity as Entity)\n  }\n\n  private static removeTriggerFromSystem(wrapper: TriggerWrapper) {\n    let activeCollisions = wrapper.getActiveCollisions()\n    for (let i = 0; i < activeCollisions.length; i++) {\n      let activeCollisionHasTrigger = !(\n        activeCollisions[i] === NPCTriggerSystem._instance?._cameraTriggerWrapper ||\n        activeCollisions[i].trigger == null\n      )\n\n      if (activeCollisionHasTrigger && activeCollisions[i].trigger.onTriggerExit && wrapper.entity)\n        (activeCollisions[i].trigger.onTriggerExit as (entity: IEntity) => void)(wrapper.entity)\n      activeCollisions[i].disengageActiveCollision(wrapper)\n      wrapper.disengageActiveCollision(activeCollisions[i])\n    }\n  }\n\n  private static disengageCollision(t1: TriggerWrapper, t2: TriggerWrapper) {\n    t1.disengageActiveCollision(t2)\n    t2.disengageActiveCollision(t1)\n\n    if (t1.trigger.onTriggerExit && t2.entity) t1.trigger.onTriggerExit(t2.entity)\n    if (t2.trigger.onTriggerExit && t1.entity) t2.trigger.onTriggerExit(t1.entity)\n  }\n\n  private static engageCollision(t1: TriggerWrapper, t2: TriggerWrapper) {\n    t1.engageCollision(t2)\n    t2.engageCollision(t1)\n\n    if (t1.trigger.onTriggerEnter && t2.entity) t1.trigger.onTriggerEnter(t2.entity)\n    if (t2.trigger.onTriggerEnter && t1.entity) t2.trigger.onTriggerEnter(t1.entity)\n  }\n\n  private checkCollisionAgainstCamera(wrapper: TriggerWrapper) {\n    let wereColliding = wrapper.hasActiveCollision(this._cameraTriggerWrapper)\n    let areColliding = NPCTriggerSystem.areColliding(wrapper, this._cameraTriggerWrapper)\n\n    if (wereColliding && !areColliding) {\n      wrapper.disengageActiveCollision(this._cameraTriggerWrapper)\n      if (wrapper.trigger.onCameraExit) wrapper.trigger.onCameraExit()\n    } else if (!wereColliding && areColliding) {\n      wrapper.engageCollision(this._cameraTriggerWrapper)\n      if (wrapper.trigger.onCameraEnter) wrapper.trigger.onCameraEnter()\n    }\n  }\n\n  private checkCollisionAgainstOtherTriggers(wrapper: TriggerWrapper) {\n    for (const key in this._triggers) {\n      if (this._triggers.hasOwnProperty(key)) {\n        if (key != wrapper.uuid && this._triggers[key].trigger.enabled) {\n          if (NPCTriggerSystem.canTriggersCollide(wrapper, this._triggers[key])) {\n            let wereColliding = wrapper.hasActiveCollision(this._triggers[key])\n            let areColliding = NPCTriggerSystem.areColliding(wrapper, this._triggers[key])\n\n            if (wereColliding && !areColliding)\n              NPCTriggerSystem.disengageCollision(wrapper, this._triggers[key])\n            else if (!wereColliding && areColliding)\n              NPCTriggerSystem.engageCollision(wrapper, this._triggers[key])\n          }\n        }\n      }\n    }\n  }\n\n  private static canTriggersCollide(t1: TriggerWrapper, t2: TriggerWrapper): boolean {\n    if (t1.trigger.triggeredByLayer == 0) return true\n    return (t2.trigger.layer & t1.trigger.triggeredByLayer) != 0\n  }\n\n  private static areColliding(t1: TriggerWrapper, t2: TriggerWrapper): boolean {\n    if (t1.getShape() instanceof TriggerBoxShape && t2.getShape() instanceof TriggerBoxShape) {\n      return NPCTriggerSystem.areCollidingAABB(\n        t1.getGlobalPosition(),\n        t1.getShape() as TriggerBoxShape,\n        t2.getGlobalPosition(),\n        t2.getShape() as TriggerBoxShape\n      )\n    } else if (\n      t1.getShape() instanceof TriggerSphereShape &&\n      t2.getShape() instanceof TriggerSphereShape\n    ) {\n      return NPCTriggerSystem.areCollidingSphere(\n        t1.getGlobalPosition(),\n        t1.getShape() as TriggerSphereShape,\n        t2.getGlobalPosition(),\n        t2.getShape() as TriggerSphereShape\n      )\n    } else if (\n      t1.getShape() instanceof TriggerBoxShape &&\n      t2.getShape() instanceof TriggerSphereShape\n    ) {\n      return NPCTriggerSystem.areCollidingAABBSphere(\n        t1.getGlobalPosition(),\n        t1.getShape() as TriggerBoxShape,\n        t2.getGlobalPosition(),\n        t2.getShape() as TriggerSphereShape\n      )\n    } else if (\n      t1.getShape() instanceof TriggerSphereShape &&\n      t2.getShape() instanceof TriggerBoxShape\n    ) {\n      return NPCTriggerSystem.areCollidingAABBSphere(\n        t2.getGlobalPosition(),\n        t2.getShape() as TriggerBoxShape,\n        t1.getGlobalPosition(),\n        t1.getShape() as TriggerSphereShape\n      )\n    }\n    return false\n  }\n\n  private static areCollidingAABB(\n    t1GlobalPosition: Vector3,\n    t1Shape: TriggerBoxShape,\n    t2GlobalPosition: Vector3,\n    t2Shape: TriggerBoxShape\n  ): boolean {\n    let t1 = NPCTriggerSystem.getBoxShapeValues(t1GlobalPosition, t1Shape)\n    let t2 = NPCTriggerSystem.getBoxShapeValues(t2GlobalPosition, t2Shape)\n    return (\n      t1.min.x <= t2.max.x &&\n      t1.max.x >= t2.min.x &&\n      t1.min.y <= t2.max.y &&\n      t1.max.y >= t2.min.y &&\n      t1.min.z <= t2.max.z &&\n      t1.max.z >= t2.min.z\n    )\n  }\n\n  private static areCollidingSphere(\n    t1GlobalPosition: Vector3,\n    t1Shape: TriggerSphereShape,\n    t2GlobalPosition: Vector3,\n    t2Shape: TriggerSphereShape\n  ): boolean {\n    let sqDist = Vector3.DistanceSquared(\n      t1GlobalPosition.add(t1Shape.position),\n      t2GlobalPosition.add(t2Shape.position)\n    )\n    return sqDist < t1Shape.radius * t1Shape.radius + t2Shape.radius * t2Shape.radius\n  }\n\n  private static areCollidingAABBSphere(\n    t1GlobalPosition: Vector3,\n    t1Shape: TriggerBoxShape,\n    t2GlobalPosition: Vector3,\n    t2Shape: TriggerSphereShape\n  ): boolean {\n    let box = NPCTriggerSystem.getBoxShapeValues(t1GlobalPosition, t1Shape)\n    let sphere = {\n      center: t2GlobalPosition.add(t2Shape.position),\n      radius: t2Shape.radius\n    }\n\n    let dmin = 0\n    if (sphere.center.x < box.min.x)\n      dmin += (box.min.x - sphere.center.x) * (box.min.x - sphere.center.x)\n    if (sphere.center.x > box.max.x)\n      dmin += (sphere.center.x - box.max.x) * (sphere.center.x - box.max.x)\n    if (sphere.center.y < box.min.y)\n      dmin += (box.min.y - sphere.center.y) * (box.min.y - sphere.center.y)\n    if (sphere.center.y > box.max.y)\n      dmin += (sphere.center.y - box.max.y) * (sphere.center.y - box.max.y)\n    if (sphere.center.z < box.min.z)\n      dmin += (box.min.z - sphere.center.z) * (box.min.z - sphere.center.z)\n    if (sphere.center.z > box.max.z)\n      dmin += (sphere.center.z - box.max.z) * (sphere.center.z - box.max.z)\n\n    return dmin < sphere.radius * sphere.radius\n  }\n\n  private static getBoxShapeValues(\n    entityGlobalPosition: Vector3,\n    shape: TriggerBoxShape\n  ): { center: Vector3; min: Vector3; max: Vector3 } {\n    let center = entityGlobalPosition.add(shape.position)\n    return {\n      center: center,\n      min: center.subtract(shape.size.scale(0.5)),\n      max: center.add(shape.size.scale(0.5))\n    }\n  }\n}\n\nclass TriggerWrapper {\n  wasEnabled: boolean = true\n\n  get entity(): Entity | undefined {\n    return this._entity\n  }\n  get trigger(): NPCTriggerComponent {\n    return this._trigger\n  }\n  get uuid(): string {\n    return this._uuid\n  }\n\n  protected _entity?: Entity\n  protected _trigger!: NPCTriggerComponent\n  protected _uuid: string = ''\n  protected _collidingWith: Record<string, TriggerWrapper> = {}\n\n  private _isDebug: boolean = false\n  private _debugEntity: Entity | null = null\n  private static _debugMaterial: Material | null = null\n\n  constructor(entity?: Entity) {\n    this._entity = entity\n    if (entity) {\n      this._trigger = entity.getComponent(NPCTriggerComponent)\n      this._uuid = entity.uuid\n      this._isDebug = this._trigger.debugEnabled\n      if (this._isDebug) {\n        this.addDebugEntity()\n      }\n    }\n  }\n\n  getGlobalPosition(): Vector3 {\n    if (this._entity) return TriggerWrapper.getEntityWorldPosition(this._entity)\n    return Vector3.Zero()\n  }\n\n  getShape(): TriggerBoxShape | TriggerSphereShape {\n    return this._trigger.shape\n  }\n\n  isInEngine(): boolean {\n    return this._entity != null && this._entity.isAddedToEngine()\n  }\n\n  getActiveCollisions(): TriggerWrapper[] {\n    let ret: TriggerWrapper[] = []\n\n    for (const key in this._collidingWith) {\n      if (this._collidingWith.hasOwnProperty(key)) {\n        ret.push(this._collidingWith[key])\n      }\n    }\n    return ret\n  }\n\n  hasActiveCollision(other: TriggerWrapper): boolean {\n    return this._collidingWith[other.uuid] != undefined && this._collidingWith[other.uuid] != null\n  }\n\n  disengageActiveCollision(other: TriggerWrapper) {\n    delete this._collidingWith[other.uuid]\n  }\n\n  engageCollision(other: TriggerWrapper) {\n    this._collidingWith[other.uuid] = other\n  }\n\n  isDebugging(): boolean {\n    return this._isDebug\n  }\n\n  addDebugEntity() {\n    if (!TriggerWrapper._debugMaterial) {\n      TriggerWrapper._debugMaterial = new Material()\n      TriggerWrapper._debugMaterial.alphaTest = 0.5\n    }\n\n    if (this._debugEntity == null) {\n      this._debugEntity = new Entity()\n\n      const transform = new Transform()\n      this._debugEntity.addComponent(transform)\n      this._debugEntity.addComponent(TriggerWrapper._debugMaterial)\n\n      if (this.getShape() instanceof TriggerBoxShape) {\n        const shape = new BoxShape()\n        shape.withCollisions = false\n        this._debugEntity.addComponent(shape)\n        transform.scale = (this.getShape() as TriggerBoxShape).size\n      }\n      if (this.getShape() instanceof TriggerSphereShape) {\n        const shape = new SphereShape()\n        shape.withCollisions = false\n        this._debugEntity.addComponent(shape)\n        let rad = (this.getShape() as TriggerSphereShape).radius\n        transform.scale = new Vector3(rad, rad, rad)\n      }\n    }\n    engine.addEntity(this._debugEntity)\n  }\n\n  removeDebugEntity() {\n    if (this._debugEntity != null) engine.removeEntity(this._debugEntity)\n  }\n\n  updateDebugEntity() {\n    if (this._debugEntity) {\n      this._debugEntity.getComponent(Transform).position = this.getGlobalPosition().add(\n        this.getShape().position\n      )\n    }\n  }\n\n  private static getEntityWorldPosition(entity: IEntity): Vector3 {\n    let entityPosition = entity.hasComponent(Transform)\n      ? entity.getComponent(Transform).position.clone()\n      : Vector3.Zero()\n    let parentEntity = entity.getParent()\n\n    if (parentEntity != null) {\n      let parentRotation = parentEntity.hasComponent(Transform)\n        ? parentEntity.getComponent(Transform).rotation\n        : Quaternion.Identity\n      return this.getEntityWorldPosition(parentEntity).add(entityPosition.rotate(parentRotation))\n    }\n    return entityPosition\n  }\n}\n\nclass CameraTrigger extends TriggerWrapper {\n  private _shape: TriggerBoxShape | TriggerSphereShape\n\n  constructor(shape: TriggerBoxShape | TriggerSphereShape) {\n    super()\n    this._shape = shape\n    this._uuid = 'cameraTrigger'\n  }\n\n  getGlobalPosition() {\n    return Camera.instance.position\n  }\n\n  getShape() {\n    return this._shape\n  }\n\n  setShape(shape: TriggerBoxShape | TriggerSphereShape) {\n    this._shape = shape\n  }\n\n  isInEngine(): boolean {\n    return false\n  }\n\n  hasActiveCollision(other: TriggerWrapper): boolean {\n    return false\n  }\n\n  disengageActiveCollision(other: TriggerWrapper) {}\n\n  engageCollision(other: TriggerWrapper) {}\n  isDebugging(): boolean {\n    return false\n  }\n}\n\n@Component('npcTriggerComponent')\nexport class NPCTriggerComponent {\n  /**\n   * is trigger enable?\n   */\n  enabled: boolean = true\n  /**\n   * shape of the collider\n   */\n  shape: TriggerBoxShape | TriggerSphereShape\n  /**\n   * bit layer of the Tigger (usefull to discriminate between trigger events)\n   */\n  layer: number = 0\n  /**\n   * against which layer are we going to check trigger's collisions\n   */\n  triggeredByLayer: number = 0\n  /**\n   * callback when trigger is entered\n   */\n  onTriggerEnter?: (entity: Entity) => void\n  /**\n   * callback when trigger is exit\n   */\n  onTriggerExit?: (entity: Entity) => void\n  /**\n   * callback when trigger is entered\n   */\n  onCameraEnter?: () => void\n  /**\n   * callback when trigger is exit\n   */\n  onCameraExit?: () => void\n  /**\n   * get if debug is enabled\n   */\n  get debugEnabled(): boolean {\n    return this._debugEnabled\n  }\n\n  private _debugEnabled: boolean\n\n  /**\n   *\n   * @param {TriggerBoxShape | TriggerSphereShape} shape shape of the triggering collider area\n   * @param {TriggerData} data Object of type TriggerData, including the following optional fields: onCameraEnter, onCameraExit, onTriggerEnter, onTriggerExit, layer, triggeredByLayer, enableDebug\n   */\n  constructor(shape: TriggerBoxShape | TriggerSphereShape, data?: TriggerData) {\n    NPCTriggerSystem.createAndAddToEngine()\n    this.shape = shape\n    this.layer = data && data.layer ? data.layer : 0\n    this.triggeredByLayer = data && data.triggeredByLayer ? data.triggeredByLayer : 0\n    this.onTriggerEnter = data && data.onTriggerEnter ? data.onTriggerEnter : undefined\n    this.onTriggerExit = data && data.onTriggerExit ? data.onTriggerExit : undefined\n    this.onCameraEnter = data && data.onCameraEnter ? data.onCameraEnter : undefined\n    this.onCameraExit = data && data.onCameraExit ? data.onCameraExit : undefined\n    this._debugEnabled = data && data.enableDebug ? data.enableDebug : false\n  }\n}\n\nexport class TriggerBoxShape {\n  size: Vector3\n  position: Vector3\n\n  constructor(size: Vector3, position: Vector3) {\n    this.size = size\n    this.position = position\n  }\n}\n\nexport class TriggerSphereShape {\n  radius: number\n  position: Vector3\n\n  constructor(radius: number, position: Vector3) {\n    this.radius = radius\n    this.position = position\n  }\n}\n","import { NPCLerpType, NPCState } from '../utils/types'\nimport { NPC } from './npc'\n\n@Component('npclerpData')\nexport class NPCLerpData {\n  path: Vector3[]\n  origin: number = 0\n  target: number = 1\n  fraction: number = 0\n  totalDuration: number = 0\n  speed: number[] = []\n  loop: boolean = false\n  type: NPCLerpType = NPCLerpType.SMOOTH_PATH //default\n  onFinishCallback?: () => void\n  onReachedPointCallback?: () => void\n  constructor(path: Vector3[],type:NPCLerpType=NPCLerpType.SMOOTH_PATH) {\n    this.path = path\n    if(type !== undefined) this.type = type\n    NPCWalkSystem.createAndAddToEngine()\n  }\n\n  setIndex(index: number) {\n    this.fraction = 0\n    this.origin = index\n    this.target = index + 1 < this.path.length ? index + 1 : 0\n  }\n}\n\nconst walkingNPCGroup = engine.getComponentGroup(NPCLerpData)\n\nexport class NPCWalkSystem implements ISystem {\n  static _instance: NPCWalkSystem | null = null\n  update(dt: number) {\n    for (let npcE of walkingNPCGroup.entities) {\n      const npc = (npcE as NPC)\n      //try{\n      if (npc.state == NPCState.FOLLOWPATH) {\n        let transform = npc.getComponent(Transform)\n        let path = npc.getComponent(NPCLerpData)\n\n        if(path.type !== undefined && path.type == NPCLerpType.RIGID_PATH){\n          //stop exactly at each point\n          if (path.fraction < 1) {\n            path.fraction += dt * path.speed[path.origin]\n\n            //if fraction goes over 1 push it back to 1?\n\n            transform.position = Vector3.Lerp(\n              path.path[path.origin],\n              path.path[path.target],\n              path.fraction\n            )\n          } else {\n            path.origin = path.target\n            path.target += 1\n            if (path.target >= path.path.length) {\n              if (path.loop) {\n                path.target = 0\n              } else {\n                npc.stopWalking()\n                if (path.onFinishCallback) {\n                  path.onFinishCallback()\n                }\n                path.fraction = 1\n                return\n              }\n            } else if (path.onReachedPointCallback) {\n              path.onReachedPointCallback()\n            }\n            path.fraction = 0 //starts on this point\n            transform.lookAt(path.path[path.target])\n          }\n        }else{\n          //default follow, smooth but with low FPS could cut corners\n          //always increment fraction\n          path.fraction += dt * path.speed[path.origin]\n\n          if(path.fraction >= 1){\n            path.origin = path.target\n            const tartInc = Math.max(1,Math.floor( path.fraction ))\n            path.target += tartInc\n            if (path.target >= path.path.length) {\n              if (path.loop) {\n                path.target = 0\n              } else {\n                //path.target = path.path.length - 1\n                npc.stopWalking()\n                if (path.onFinishCallback) {\n                  path.onFinishCallback()\n                }\n                path.fraction = 1\n                return\n              }\n            } else if (path.onReachedPointCallback) {\n              path.onReachedPointCallback()\n            }\n            path.fraction -= tartInc\n            //TODO consider lerping look at\n            if (path.target < path.path.length) {\n              transform.lookAt(path.path[path.target])\n            }\n          }\n        }\n        //if reached target\n        if (path.target < path.path.length) {\n          transform.position = Vector3.Lerp(\n            path.path[path.origin],\n            path.path[path.target],\n            path.fraction\n          )\n        }\n      }\n      /*}catch(e){\n        debugger\n        log(\"npc.utils.NPCWalkSystem throw error\",e)\n      }*/\n    }\n  }\n\n  static createAndAddToEngine(): NPCWalkSystem {\n    if (this._instance == null) {\n      this._instance = new NPCWalkSystem()\n      engine.addSystem(this._instance)\n    }\n    return this._instance\n  }\n\n  private constructor() {\n    NPCWalkSystem._instance = this\n  }\n}\n","import { bubblesTexture, setUVSection, SFHeavyFont } from \"../utils/default-ui-components\"\nimport { Dialog } from \"../utils/types\"\nimport resources from \"./resources\"\n\nlet textSize = 1\nlet textYPos = 0\n\nlet maxLengthShortBubble = 8\nlet maxLengthNormalBubble = 25\nlet maxLengthLongBubble = 50\nlet maxLengthHugeBubble = 100\n\nlet shortBubbleXOffset = -0.1\nlet normalBubbleXOffset = -0.5\nlet longBubbleXOffset = -0.8\nlet hugeBubbleXOffset = -0.8\n\nlet shortBubbleYOffset = -0.2\nlet normalBubbleYOffset = -0.2\nlet longBubbleYOffset = 0\nlet hugeBubbleYOffset = 0.2\n\nlet shortBubbleTextWidth = 0.7\nlet normalBubbleTextWidth = 1.5\nlet longBubbleTextWidth = 2\nlet hugeBubbleTextWidth = 2\n\nlet shortBubbleX = 116 * 0.005\nlet shortBubbleY = 84 * 0.005\n\nlet normalBubbleX = 286 * 0.005\nlet normalBubbleY = 84 * 0.005\n\nlet longBubbleX = 497 * 0.005\nlet longBubbleY = 153 * 0.005\n\nlet hugeBubbleX = 497 * 0.005\nlet hugeBubbleY = 239 * 0.005\n\nlet defaultYOffset = 2.5\n\n/**\n * Displays an in-world panel as a speech bubble, with text from an array of Dialog objects.\n *\n * @param parent Entity to set as parent. The Bubble will inherit the position, rotation and scale of the parent.\n * @param height Height in meters to float the bubble above the parent's position.\n * @param sound Path to a sound file to play once for every dialog window shown.\n *\n */\nexport class DialogBubble {\n  public NPCScript: Dialog[] = []\n  public container: Entity\n  public panel: Entity\n  public rootEntity: Entity\n  public text: Entity\n  public material: BasicMaterial\n  public isBubleOpen: boolean = false\n  public activeTextId: number = 0\n  public uiTheme: Texture\n  public soundEnt: Entity\n  public defaultSound: string | null = null\n  public baseYOffset: number = defaultYOffset\n  // ClickAction: null | (() => false | Subscription[]) = null\n\n  constructor(parent: Entity, height?: number, sound?: string) {\n    this.baseYOffset = height ? height : defaultYOffset\n\n   // Root\n   this.rootEntity = new Entity()\n   this.rootEntity.addComponent(new Billboard(false, true, false))\n   this.rootEntity.addComponent(new Transform())\n   this.rootEntity.setParent(parent)\n\n   // Container\n   this.container = new Entity()\n   //this.container.addComponent(new Billboard(false, true, false))\n   this.container.addComponent(\n\t new Transform({\n\t   position: new Vector3(shortBubbleXOffset, this.baseYOffset, 0),\n\t })\n   )\n   this.container.setParent(this.rootEntity)\n\n    // Material\n\tthis.material = new BasicMaterial()\n\tthis.material.texture = bubblesTexture\n\n    // Background Panel\n    this.panel = new Entity()\n    this.panel.addComponent(\n      new Transform({\n        scale: new Vector3(2, 1, 1),\n      })\n    )\n    this.panel.setParent(this.container)\n    this.panel.addComponent(new PlaneShape())\n    this.panel.addComponent(this.material)\n\tthis.panel.getComponent(PlaneShape).visible = false\n\n    setUVSection(\n      this.panel.getComponent(PlaneShape),\n      resources.bubbles.normal,\n      1024,\n      1024\n    )\n\n    // Dialog Text\n    this.text = new Entity()\n    this.text.addComponent(\n      new Transform({\n        position: new Vector3(0, textYPos, 0.05),\n        rotation: Quaternion.Euler(0, 180, 0),\n      })\n    )\n    this.text.addComponent(new TextShape(''))\n    this.text.setParent(this.container)\n\n    this.text.getComponent(TextShape).textWrapping = true\n    this.text.getComponent(TextShape).font = SFHeavyFont\n    this.text.getComponent(TextShape).hTextAlign = 'center'\n    this.text.getComponent(TextShape).vTextAlign = 'center'\n    this.text.getComponent(TextShape).fontSize = textSize\n    //this.text.getComponent(TextShape).fontWeight = 'normal'\n    this.text.getComponent(TextShape).color = Color3.Black()\n\tthis.text.getComponent(TextShape).visible = false\n\n    this.soundEnt = new Entity()\n\n    if (sound) {\n      this.soundEnt.addComponent(new Transform())\n      engine.addEntity(this.soundEnt)\n      this.soundEnt.setParent(this.container)\n\n      this.soundEnt.addComponent(new AudioSource(new AudioClip(sound)))\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n\n      this.defaultSound = sound\n    }\n\n    WorldDialogTypeInSystem.createAndAddToEngine()\n  }\n\n  /**\n   * Opens a dialog bubble to start a conversation.\n   * @param {Dialog[]} NPCScript  Instructions to follow during the conversation\n   * @param {number|string} textId Where to start in the script. Can refer to an index in the array or the `name` field of a Dialog entry.\n   */\n  public openDialogWindow(NPCScript: Dialog[], textId?: number | string): void {\n    this.NPCScript = NPCScript\n\n    if (!textId) {\n      this.activeTextId = 0\n    } else if (typeof textId === 'number') {\n      this.activeTextId = textId\n    } else {\n      this.activeTextId = findDialogByName(NPCScript, textId)\n    }\n\n    let currentText: Dialog = NPCScript[this.activeTextId]\n      ? NPCScript[this.activeTextId]\n      : { text: '' }\n\n    if (currentText.audio) {\n      this.soundEnt.addComponentOrReplace(\n        new AudioSource(new AudioClip(currentText.audio))\n      )\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    } else if (this.defaultSound) {\n      this.soundEnt.addComponentOrReplace(\n        new AudioSource(new AudioClip(this.defaultSound))\n      )\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    }\n\n    // Set text\n    this.text.getComponent(TextShape).fontSize = currentText.fontSize\n      ? currentText.fontSize\n      : textSize\n    this.text.getComponent(Transform).position.y = currentText.offsetY\n      ? currentText.offsetY + textYPos\n      : textYPos\n    this.text.getComponent(Transform).position.x = currentText.offsetX\n      ? currentText.offsetX\n      : 0\n    this.text.getComponent(TextShape).visible = true\n    this.panel.getComponent(PlaneShape).visible = true\n    this.text.getComponent(TextShape).value = ''\n\n    if (currentText.text.length < maxLengthHugeBubble) {\n      currentText.text.slice(0, maxLengthHugeBubble)\n    }\n\n    WorldDialogTypeInSystem._instance!.newText(\n      this,\n      currentText.text,\n      this.activeTextId,\n      currentText.timeOn ? currentText.timeOn : undefined,\n      currentText.typeSpeed ? currentText.typeSpeed : undefined\n    )\n\n    this.adjustBubble(currentText.text.length)\n\n    // Global button events\n    //   if (!this.ClickAction) {\n    // \tthis.ClickAction = Input.instance.subscribe(\n    // \t  'BUTTON_DOWN',\n    // \t  ActionButton.POINTER,\n    // \t  false,\n    // \t  (e) => {\n    // \t\tif (!this.isDialogOpen || +Date.now() - this.UIOpenTime < 100) return\n\n    // \t\tif (!DialogTypeInSystem._instance!.done) {\n    // \t\t  DialogTypeInSystem._instance!.rush()\n    // \t\t  return\n    // \t\t} else if (!this.isQuestionPanel && !this.isFixedScreen) {\n    // \t\t  this.confirmText(ConfirmMode.Next)\n    // \t\t}\n    // \t  }\n    // \t)\n\n    // }\n\n    this.layoutDialogWindow(this.activeTextId)\n    this.isBubleOpen = true\n  }\n\n  private adjustBubble(textLength: number): void {\n    if (textLength < maxLengthShortBubble) {\n      setUVSection(\n        this.panel.getComponent(PlaneShape),\n        resources.bubbles.short,\n        1024,\n        1024\n      )\n      this.panel.getComponent(Transform).scale.x = shortBubbleX\n      this.panel.getComponent(Transform).scale.y = shortBubbleY\n      this.container.getComponent(Transform).position.x = shortBubbleXOffset\n      this.container.getComponent(Transform).position.y =\n        this.baseYOffset + shortBubbleYOffset\n      this.text.getComponent(TextShape).width = shortBubbleTextWidth\n    } else if (textLength < maxLengthNormalBubble) {\n      setUVSection(\n        this.panel.getComponent(PlaneShape),\n        resources.bubbles.normal,\n        1024,\n        1024\n      )\n      this.panel.getComponent(Transform).scale.x = normalBubbleX\n      this.panel.getComponent(Transform).scale.y = normalBubbleY\n      this.container.getComponent(Transform).position.x = normalBubbleXOffset\n      this.container.getComponent(Transform).position.y =\n        this.baseYOffset + normalBubbleYOffset\n      this.text.getComponent(TextShape).width = normalBubbleTextWidth\n    } else if (textLength < maxLengthLongBubble) {\n      setUVSection(\n        this.panel.getComponent(PlaneShape),\n        resources.bubbles.long,\n        1024,\n        1024\n      )\n      this.panel.getComponent(Transform).scale.x = longBubbleX\n      this.panel.getComponent(Transform).scale.y = longBubbleY\n      this.container.getComponent(Transform).position.y =\n        this.baseYOffset + longBubbleYOffset\n      this.container.getComponent(Transform).position.x = longBubbleXOffset\n      this.text.getComponent(TextShape).width = longBubbleTextWidth\n    } else {\n      setUVSection(\n        this.panel.getComponent(PlaneShape),\n        resources.bubbles.huge,\n        1024,\n        1024\n      )\n      this.panel.getComponent(Transform).scale.x = hugeBubbleX\n      this.panel.getComponent(Transform).scale.y = hugeBubbleY\n      this.container.getComponent(Transform).position.y =\n        this.baseYOffset + hugeBubbleYOffset\n      this.container.getComponent(Transform).position.x = hugeBubbleXOffset\n      this.text.getComponent(TextShape).width = hugeBubbleTextWidth\n    }\n  }\n\n  // Progresses text\n  public next(): void {\n    let currentText = this.NPCScript[this.activeTextId]\n\n\tif(!currentText){\n\t\tcurrentText = this.NPCScript[this.activeTextId-1]\n\t}\n\n    if (currentText.triggeredByNext) {\n      currentText.triggeredByNext()\n    }\n\n\tif (currentText.isEndOfDialog) {\n\t\tthis.closeDialogWindow()\n\t\treturn\n\t  }\n   \n\t // Update active text\n    this.activeTextId++\n\n    // Update active text with new active text\n    currentText = this.NPCScript[this.activeTextId]\n\n    if (currentText.text.length < maxLengthHugeBubble) {\n      currentText.text.slice(0, maxLengthHugeBubble)\n    }\n    this.text.getComponent(TextShape).value = ''\n\n    this.adjustBubble(currentText.text.length)\n\n    WorldDialogTypeInSystem._instance!.newText(\n      this,\n      currentText.text,\n      this.activeTextId,\n      currentText.timeOn ? currentText.timeOn : undefined,\n      currentText.typeSpeed ? currentText.typeSpeed : undefined\n    )\n\tthis.layoutDialogWindow(this.activeTextId)\n\n  }\n\n  // Adds the buttons or mouse icon depending on the type of window\n  public layoutDialogWindow(textId: number): void {\n    let currentText: Dialog = this.NPCScript[textId]\n      ? this.NPCScript[textId]\n      : { text: '' }\n\n    // Update text\n    let textY = currentText.offsetY ? currentText.offsetY + textYPos : textYPos\n\n    if (currentText.buttons && currentText.buttons.length >= 3) {\n      textY += 50\n    } else if (currentText.buttons && currentText.buttons.length >= 1) {\n      textY += 24\n    }\n\n    this.text.getComponent(TextShape).fontSize = currentText.fontSize\n      ? currentText.fontSize\n      : textSize\n    \n\tthis.text.getComponent(TextShape).visible = true\n\tthis.text.getComponent(Transform).position.y = textY\n\n    if (currentText.audio) {\n      this.soundEnt.addComponentOrReplace(\n        new AudioSource(new AudioClip(currentText.audio))\n      )\n      this.soundEnt.getComponent(AudioSource).volume = 0.5\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    } else if (this.defaultSound) {\n      this.soundEnt.addComponentOrReplace(\n        new AudioSource(new AudioClip(this.defaultSound))\n      )\n      this.soundEnt.getComponent(AudioSource).playOnce()\n    }\n  }\n\n  /**\n   * Closes the dialog bubble, executing associated triggeredByNext functions.\n   */\n  public closeDialogWindow(): void {\n    if (this.isBubleOpen) {\n      this.isBubleOpen = false\n\n      this.text.getComponent(TextShape).value = ''\n      this.text.getComponent(TextShape).visible = false\n\n      this.panel.getComponent(PlaneShape).visible = false\n    }\n  }\n\n   /**\n   * Closes the dialog bubble, and stops executed any associated triggeredByNext actions.\n   */\n  public closeDialogEndAll(): void {\n    if (this.isBubleOpen) {\n    \n\t  if(WorldDialogTypeInSystem._instance.Dialog == this){\n\t\tWorldDialogTypeInSystem._instance.done = true\n\t\tWorldDialogTypeInSystem._instance.Dialog = null\n\t  }\n\t  this.isBubleOpen = false\n\n      this.text.getComponent(TextShape).value = ''\n      this.text.getComponent(TextShape).visible = false\n      this.panel.getComponent(PlaneShape).visible = false\n\t  \n    }\n  }\n\n  public skipDialogs() {\n    if (!this.isBubleOpen) return\n\n\n    while (\n      this.NPCScript[this.activeTextId]\n    ) {\n\n\t\tif (this.NPCScript[this.activeTextId].triggeredByNext) {\n\t\t\tthis.NPCScript[this.activeTextId].triggeredByNext()\n\t\t  }\n      \n      if (\n        this.NPCScript[this.activeTextId].isEndOfDialog\n      ) {\n        this.closeDialogWindow()\n        return\n      }\n\t  this.activeTextId += 1\n    }\n\n  }\n}\n\nconst DEFAULT_SPEED = 45\n\nconst DEFAULT_TIME_ON = 3\n\nexport class WorldDialogTypeInSystem implements ISystem {\n  static _instance: WorldDialogTypeInSystem | null = null\n\n  timer: number = 0\n  speed: number = DEFAULT_SPEED\n  visibleChars: number = 0\n  fullText: string = ''\n  Dialog: DialogBubble | null\n  Text: TextShape | null = null\n  textId: number = 0\n  done: boolean = true\n  showing: boolean = false\n  timeOn: number = DEFAULT_TIME_ON\n  window: DialogBubble\n\n  static createAndAddToEngine(): WorldDialogTypeInSystem {\n    if (this._instance == null) {\n      this._instance = new WorldDialogTypeInSystem()\n      engine.addSystem(this._instance)\n    }\n    return this._instance\n  }\n\n  private constructor() {\n    WorldDialogTypeInSystem._instance = this\n  }\n\n  update(dt: number) {\n    if (this.done) return\n\n    this.timer += dt\n    if (this.showing) {\n      if (this.timer > this.timeOn) {\n        this.showing = false\n        this.done = true\n\t\tthis.timer = 0\n        this.window.next()\n      }\n    } else if (this.timer >= 2 / this.speed) {\n      let charsToAdd = Math.floor(this.timer / (1 / this.speed))\n      this.timer = 0\n      this.visibleChars += charsToAdd\n\n\t   // support <> tags\n\t   this.closeTag(charsToAdd)\n\n      if (this.visibleChars >= this.fullText.length) {\n        this.showing = true\n        this.timer = 0\n        this.visibleChars = this.fullText.length\n      }\n      if (this.Text) {\n        this.Text.value = this.fullText.substr(0, this.visibleChars)\n      }\n    }\n  }\n\n  newText(\n    dialog: DialogBubble,\n    text: string,\n    textId: number,\n    timeOn?: number,\n    speed?: number\n  ) {\n\n\t// prevent circular loops\n\tif(dialog == this.Dialog && textId == this.textId){\n\t\treturn\n\t}\n\n\tlet oldDialog = this.Dialog\n\n\tthis.Dialog = dialog\n\tthis.Text = this.Dialog.text.getComponent(TextShape)\n\tthis.textId = textId\n\n\tif(oldDialog && dialog != oldDialog){\n\t\toldDialog.skipDialogs()\n\t} \n\t\n\n    this.timer = 0\n    this.done = false\n    this.showing = false\n    \n    this.fullText = text\n    this.visibleChars = 0\n    this.window = dialog\n\n    if (speed && speed <= 0) {\n      this.rush()\n    } else if (speed) {\n      this.speed = speed\n    } else {\n      this.speed = DEFAULT_SPEED\n    }\n\n    if (timeOn) {\n      this.timeOn = timeOn\n    } else {\n      this.timeOn = DEFAULT_TIME_ON\n    }\n\n    // Buttons & action icons\n    //dialog.layoutDialogWindow(textId)\n  }\n  rush() {\n    this.showing = true\n    this.timer = 0\n    this.visibleChars = this.fullText.length\n\n    if (this.Text) {\n      this.Text.value = this.fullText\n    }\n  }\n  closeTag(newChars: number){\n\tif(this.visibleChars == 0 || newChars ==0 ) return\n\n\tlet openTag: boolean = false\n\tlet closeTag : boolean = false\n\tfor(let i = this.visibleChars-newChars; i < this.visibleChars ; i++){\n\t  \n\t  if(!openTag){\n\t\t  if(this.fullText.substr(i, 1) == '<'){\n\t\t\t  openTag= true\n\t\t\t  \n\t\t  }\n\t  } else {\n\t\t  if(this.fullText.substr(i, 1) == '>'){\n\t\t\t  closeTag= true\n\t\t\t  \n\t\t  }\n\t  }\n\t}\n\n\tif(!openTag || closeTag){\t\n\t\treturn\n\t}\n\n\twhile(this.visibleChars < this.fullText.length && this.fullText.substr(this.visibleChars-1, 1) != '>'){\n\t\tthis.visibleChars+=1\n\t}\n\treturn\n}\n}\n\nfunction findDialogByName(dialogs: Dialog[], name: string) {\n  for (let i = 0; i < dialogs.length; i++) {\n    if (dialogs[i].name && dialogs[i].name == name) {\n      return i\n    }\n  }\n  return 0\n}\n","import { DialogWindow } from '../ui/index'\nimport { Dialog, FollowPathData, NPCData, NPCState, TriggerData } from '../utils/types'\nimport { TrackUserFlag } from './faceUserSystem'\n\nimport { TriggerSphereShape, NPCTriggerComponent } from '../trigger/triggerSystem'\nimport { NPCDelay } from '../utils/timerComponents'\nimport { NPCLerpData } from './move'\nimport { DialogBubble } from '../ui/bubble'\n\n/**\n * Creates a talking, walking and animated NPC\n *\n * @param {TranformConstructorArgs} position Transform argument object that can contain position, rotation and scale for NPC\n * @param {string} model String with path to 3D model to use for NPC\n * @param {() => void} onActivate Function to execute each time the NPC is activated. By default when clicking it or walking near, or calling the `activate()` function\n * @param {NPCData} data Object of type NPCData, containing multiple configurable parameters\n *\n */\nexport class NPC extends Entity {\n  public introduced: boolean = false\n  public dialog: DialogWindow\n  public bubble: DialogBubble | undefined\n  public onActivate: () => void\n  public onWalkAway: null | (() => void) = null\n  public inCooldown: boolean = false\n  public coolDownDuration: number = 5\n  public faceUser: boolean = false\n  public idleAnim: AnimationState\n  public walkingAnim: null | AnimationState = null\n  public walkingSpeed: number = 2\n  public lastPlayedAnim: AnimationState\n  public endAnimTimer: Entity\n  public closeDialogTimer: Entity\n  public pauseWalkingTimer: Entity\n  public state: NPCState\n  public bubbleHeight: number = 2\n  /**\n   * Creates a talking, walking and animated NPC\n   *\n   * @param {TranformConstructorArgs} position Transform argument object that can contain position, rotation and scale for NPC\n   * @param {string} model String with path to 3D model to use for NPC\n   * @param {() => void} onActivate Function to execute each time the NPC is activated. By default when clicking it or walking near, or calling the `activate()` function\n   * @param {NPCData} data Object of type NPCData, containing multiple configurable parameters\n   *\n   */\n  constructor(\n    position: TranformConstructorArgs,\n    model: string,\n    onActivate: () => void,\n    data?: NPCData\n  ) {\n    super()\n    this.addComponent(new GLTFShape(model))\n    this.addComponent(new Transform(position))\n    engine.addEntity(this)\n\n    this.state = NPCState.STANDING\n\n    // dialogs\n    if (data && data.noUI) {\n    } else if (data && data.portrait) {\n      this.dialog = new DialogWindow(\n        typeof data.portrait === `string` ? { path: data.portrait } : data.portrait,\n        data && data.darkUI ? data.darkUI : false,\n        data.dialogSound ? data.dialogSound : undefined,\n        data && data.dialogCustomTheme ? data.dialogCustomTheme : undefined\n      )\n    } else {\n      this.dialog = new DialogWindow(\n        undefined,\n        data && data.darkUI ? data.darkUI : false,\n        data && data.dialogSound ? data.dialogSound : undefined,\n        data && data.dialogCustomTheme ? data.dialogCustomTheme : undefined\n      )\n    }\n\n    if (data && data.textBubble) {\n      if (data && data.bubbleHeight) {\n        this.bubbleHeight = data.bubbleHeight\n      }\n      this.bubble = new DialogBubble(\n        this,\n        this.bubbleHeight,\n        data.dialogSound ? data.dialogSound : undefined\n      )\n    }\n\n    // animations\n    this.addComponent(new Animator())\n\n    this.idleAnim = new AnimationState(data && data.idleAnim ? data.idleAnim : 'Idle', {\n      looping: true,\n    })\n    this.getComponent(Animator).addClip(this.idleAnim)\n    this.lastPlayedAnim = this.idleAnim\n    this.idleAnim.play()\n\n    if (data && data.walkingAnim) {\n      this.walkingAnim = new AnimationState(data.walkingAnim, {\n        looping: true,\n      })\n      this.getComponent(Animator).addClip(this.walkingAnim)\n    }\n\n    this.onActivate = onActivate\n\n    if (data && data.onWalkAway) {\n      this.onWalkAway = data.onWalkAway\n    }\n\n    this.endAnimTimer = new Entity()\n    engine.addEntity(this.endAnimTimer)\n\n    this.closeDialogTimer = new Entity()\n    engine.addEntity(this.closeDialogTimer)\n\n    this.pauseWalkingTimer = new Entity()\n    engine.addEntity(this.pauseWalkingTimer)\n\n    let activateButton = data && data.onlyClickTrigger ? ActionButton.POINTER : ActionButton.PRIMARY\n\n    // Reaction when clicked\n    this.addComponent(\n      new OnPointerDown(\n        (e) => {\n          if (this.inCooldown || (this.dialog && this.dialog.isDialogOpen)) return\n\n          this.activate()\n        },\n        {\n          button: activateButton,\n          hoverText: data && data.hoverText ? data.hoverText : 'Talk',\n          showFeedback: data && data.onlyExternalTrigger ? false : true,\n        }\n      )\n    )\n\n    if (data && data.onlyExternalTrigger) {\n      this.removeComponent(OnPointerDown)\n    }\n\n    // Trigger\n    let triggerData: TriggerData = {}\n\n    // when exiting trigger\n    if (!data || (data && !data.continueOnWalkAway)) {\n      triggerData.onCameraExit = () => {\n        this.handleWalkAway()\n      }\n    }\n\n    // when entering trigger\n    if (\n      !data ||\n      (data && !data.onlyExternalTrigger && !data.onlyClickTrigger && !data.onlyETrigger)\n    ) {\n      triggerData.onCameraEnter = () => {\n        if (this.inCooldown) {\n          log(this.name, ' in cooldown')\n          return\n        } else if (\n          (this.dialog && this.dialog.isDialogOpen) ||\n          (data && data.onlyExternalTrigger) ||\n          (data && data.onlyClickTrigger)\n        ) {\n          return\n        }\n        this.activate()\n      }\n    }\n\n    // add trigger\n    if (triggerData.onCameraEnter || triggerData.onCameraExit) {\n      this.addComponent(\n        new NPCTriggerComponent(\n          new TriggerSphereShape(\n            data && data.reactDistance ? data.reactDistance : 6,\n            Vector3.Zero()\n          ),\n          triggerData\n        )\n      )\n    }\n\n    if (data && data.faceUser) {\n      this.addComponent(new TrackUserFlag(true, data.turningSpeed ? data.turningSpeed : undefined))\n      this.faceUser = true\n    }\n\n    if (data && data.walkingSpeed) {\n      this.walkingSpeed = data.walkingSpeed\n    }\n\n    if (data && data.coolDownDuration) {\n      this.coolDownDuration = data.coolDownDuration\n    }\n\n    if (data && data.path) {\n      this.addComponent(new NPCLerpData(data.path ? data.path : [],data.pathLerpType))\n      this.getComponent(NPCLerpData).loop = true\n      \n      this.followPath()\n    }\n  }\n\n  /**\n   * Calls the NPC's activation function (set on NPC definition). If NPC has `faceUser` = true, it will rotate to face the player. It starts a cooldown counter to avoid reactivating.\n   */\n  activate() {\n    if (this.faceUser) {\n      this.getComponent(TrackUserFlag).active = true\n    }\n    this.inCooldown = true\n    this.addComponentOrReplace(\n      new NPCDelay(this.coolDownDuration, () => {\n        this.inCooldown = false\n      })\n    )\n    this.onActivate()\n  }\n  /**\n   * Closes dialog UI and makes NPC stop turning to face player\n   */\n  endInteraction() {\n    if (this.faceUser) {\n      this.getComponent(TrackUserFlag).active = false\n    }\n    if (this.dialog && this.dialog.isDialogOpen) {\n      this.dialog.closeDialogWindow()\n    }\n    if (this.bubble && this.bubble.isBubleOpen) {\n      this.bubble.closeDialogWindow()\n    }\n    this.state = NPCState.STANDING\n  }\n  /**\n   * Ends interaction and calls the onWalkAway function\n   */\n  handleWalkAway() {\n    if (this.state == NPCState.FOLLOWPATH) {\n      //|| this.state == NPCState.FOLLOWPLAYER\n      return\n    }\n\n    this.endInteraction()\n\n    if (this.onWalkAway) {\n      this.onWalkAway()\n    }\n  }\n  /**\n   * Starts a conversation, using the Dialog UI\n   * @param {Dialog[]} script Instructions to follow during the conversation\n   * @param {number|string} startIndex Where to start in the script. Can refer to an index in the array or the `name` field of a Dialog entry.\n   * @param {number} duration In seconds. If set, the UI will close after the set time\n   *\n   */\n  talk(script: Dialog[], startIndex?: number | string, duration?: number) {\n    this.introduced = true\n    this.state = NPCState.TALKING\n    if (this.closeDialogTimer.hasComponent(NPCDelay)) {\n      this.closeDialogTimer.removeComponent(NPCDelay)\n    }\n\n    if (this.bubble && this.bubble.isBubleOpen) {\n      this.bubble.closeDialogWindow()\n    }\n\n    this.dialog.openDialogWindow(script, startIndex ? startIndex : 0)\n\n    if (duration) {\n      this.closeDialogTimer.addComponentOrReplace(\n        new NPCDelay(duration, () => {\n          this.dialog.closeDialogWindow()\n        })\n      )\n    }\n  }\n\n  /**\n   * Starts a conversation, using the Dialog UI\n   * @param {Dialog[]} script Instructions to follow during the conversation\n   * @param {number|string} startIndex Where to start in the script. Can refer to an index in the array or the `name` field of a Dialog entry.\n   *\n   */\n  talkBubble(script: Dialog[], startIndex?: number | string) {\n    // this.introduced = true\n    // this.state = NPCState.TALKING\n    // if (this.closeDialogTimer.hasComponent(NPCDelay)) {\n    //   this.closeDialogTimer.removeComponent(NPCDelay)\n    // }\n\n    if (!this.bubble) {\n      this.bubble = new DialogBubble(this, this.bubbleHeight)\n    }\n\n    this.bubble.openDialogWindow(script, startIndex ? startIndex : 0)\n  }\n\n  /**\n   * The NPC model plays an animation\n   * @param {string} animationName Name of the animation to play, as stored in the model\n   * @param {boolean} noLoop If true, animation plays only once. You must also provide a duration\n   * @param {number} duration In seconds. After the duration is over, the NPC will return to the default animation.\n   *\n   */\n  playAnimation(animationName: string, noLoop?: boolean, duration?: number) {\n    // this.lastPlayedAnim.stop()\n    if (this.endAnimTimer.hasComponent(NPCDelay)) {\n      this.endAnimTimer.removeComponent(NPCDelay)\n    }\n    let newAnim = this.getComponent(Animator).getClip(animationName)\n\n    //log('playing anim : ', animationName)\n\n    if (noLoop) {\n      newAnim.looping = false\n      if (duration) {\n        this.endAnimTimer.addComponentOrReplace(\n          new NPCDelay(duration, () => {\n            newAnim.stop()\n            if (this.idleAnim) {\n              this.idleAnim.play()\n              this.lastPlayedAnim = this.idleAnim\n            }\n          })\n        )\n      }\n    }\n\n    newAnim.play()\n    this.lastPlayedAnim = newAnim\n  }\n\n  /**\n   * Change the idle animation on the NPC.\n   * @param {animation} string Name of the new animation to set as idle.\n   * @param {play} boolean If true, start playing this new idle animation.\n   */\n  changeIdleAnim(animation: string, play?: boolean) {\n    // this.idleAnim.stop()\n    this.idleAnim = new AnimationState(animation, { looping: true })\n    this.getComponent(Animator).addClip(this.idleAnim)\n    if (play) {\n      // this.lastPlayedAnim.stop()\n      this.idleAnim.play()\n      this.lastPlayedAnim = this.idleAnim\n    }\n  }\n\n  /**\n   * Instruct the NPC to walk following a path. If no data is provided, the NPC uses data from the last time `followPath` was called, or its definition.\n   * @param {FollowPathData} data Object with data to describe a path that an NPC can walk.\n   */\n  followPath(data?: FollowPathData) {\n    if (!this.hasComponent(NPCLerpData)) {\n      if (!data) {\n        return\n      }\n      this.addComponent(new NPCLerpData(data.path ? data.path : [],data.pathLerpType))\n    }\n\n    if (this.faceUser) {\n      this.getComponent(TrackUserFlag).active = false\n    }\n\n    let lerp = this.getComponent(NPCLerpData)\n\n    if (data) {\n      if (data.path) {\n        if (data.curve) {\n          let curvedPath = Curve3.CreateCatmullRomSpline(\n            data.path,\n            data.path.length * 4,\n            data.loop ? true : false\n          ).getPoints()\n          if (data.loop) {\n            curvedPath.pop()\n          }\n          lerp.path = curvedPath\n        } else {\n          lerp.path = data.path\n        }\n      }\n\n      if (data.loop != null) {\n        lerp.loop = data.loop\n      }\n\n      if (data.startingPoint != null) {\n        lerp.setIndex(data.startingPoint)\n      }\n\n      if (data.onFinishCallback) {\n        lerp.onFinishCallback = data.onFinishCallback\n      }\n\n      if (data.onReachedPointCallback) {\n        lerp.onReachedPointCallback = data.onReachedPointCallback\n      }\n    }\n\n    // add current location to start of path\n    const currentTransform = this.getComponent(Transform)\n    const currentPos = currentTransform.position\n\n    const lerpOriginPath = lerp.path[lerp.origin]\n    if(lerpOriginPath === undefined){\n      log(\"WARNING npc.utils lerpOriginPath is null\",lerpOriginPath,lerp.origin,lerp.target,lerp.path)\n    }\n    \n    if (\n      (lerp.fraction == 0 && lerpOriginPath.subtract(currentPos).lengthSquared() > 0.1) ||\n      (lerp.fraction > 0 &&\n        currentPos.subtract(lerpOriginPath).normalize() ==\n          lerp.path[lerp.target].subtract(lerpOriginPath).normalize())\n    ) {\n      lerp.path.splice(lerp.origin, 0, currentPos)\n      lerp.fraction = 0\n    }\n\n    if(lerp.path[lerp.target] === undefined){\n      log(\"npc.utils lerp.path[lerp.target] is null\",lerpOriginPath,lerp.origin,lerp.target,lerp.path)\n    }\n    currentTransform.lookAt(lerp.path[lerp.target])\n    \n    // speed of sections\n\n    let totalDist = 0\n    let pointsDist = []\n    for (let i = 0; i < lerp.path.length - 1; i++) {\n      let sqDist = Vector3.Distance(lerp.path[i], lerp.path[i + 1])\n      totalDist += sqDist\n      pointsDist.push(sqDist)\n    }\n    // measure return to start\n    if (lerp.loop) {\n      let sqDist = Vector3.Distance(lerp.path[lerp.path.length - 1], lerp.path[0])\n      totalDist += sqDist\n      pointsDist.push(sqDist)\n    }\n\n    if (data && data.totalDuration) {\n      lerp.totalDuration = data.totalDuration\n    } else if (data && data.speed) {\n      lerp.totalDuration = totalDist / data.speed\n    } else if (!lerp.totalDuration) {\n      lerp.totalDuration = totalDist / this.walkingSpeed\n    }\n\n    lerp.speed = []\n    for (let i = 0; i < pointsDist.length; i++) {\n      lerp.speed.push(1 / ((pointsDist[i] / totalDist) * lerp.totalDuration))\n    }\n\n    if (this.walkingAnim) {\n      if (this.endAnimTimer.hasComponent(NPCDelay)) {\n        this.endAnimTimer.removeComponent(NPCDelay)\n      }\n      //   this.idleAnim.stop()\n      //   this.lastPlayedAnim.stop()\n      this.walkingAnim.play()\n      this.lastPlayedAnim = this.walkingAnim\n    }\n\n    this.state = NPCState.FOLLOWPATH\n  }\n\n  /**\n   * Stops the NPC's walking. If a default animation exists, it will play it.\n   * @param {number} duration In seconds. If a duration is provided, the NPC will return to walking after the duration is over.\n   */\n  stopWalking(duration?: number) {\n    this.state = NPCState.STANDING\n\n    if (this.walkingAnim) {\n      //   this.walkingAnim.stop()\n      this.idleAnim.play()\n      this.lastPlayedAnim = this.idleAnim\n    }\n\n    if (duration) {\n      this.pauseWalkingTimer.addComponentOrReplace(\n        new NPCDelay(duration, () => {\n          if (this.dialog && this.dialog.isDialogOpen) return\n          this.lastPlayedAnim.stop()\n          if (this.walkingAnim) {\n            this.walkingAnim.play()\n            this.lastPlayedAnim = this.walkingAnim\n          }\n          if (this.endAnimTimer.hasComponent(NPCDelay)) {\n            this.endAnimTimer.removeComponent(NPCDelay)\n          }\n          this.state = NPCState.FOLLOWPATH\n        })\n      )\n    }\n  }\n}\n"],"names":["ButtonStyles","NPCState","NPCLerpType","textSize","textYPos","findDialogByName","DEFAULT_SPEED"],"mappings":"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"}